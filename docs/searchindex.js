Search.setIndex({"docnames": ["api/inverse_ray_lightcurve", "api/likelihood", "api/multipole", "api/point_source", "api/poly_solver", "api/trajectory", "api/utils", "getting_started", "index", "modules", "troubleshooting", "usage"], "filenames": ["api/inverse_ray_lightcurve.rst", "api/likelihood.rst", "api/multipole.rst", "api/point_source.rst", "api/poly_solver.rst", "api/trajectory.rst", "api/utils.rst", "getting_started.rst", "index.rst", "modules.rst", "troubleshooting.rst", "usage.rst"], "titles": ["Inverse-Ray Lightcurve", "Likelihood Utilities", "Multipole", "Point Source", "Polynomial Solver", "Trajectories", "Utility Functions", "Getting Started", "microJAX", "API Reference", "Troubleshooting", "Usage Guide"], "terms": {"index": [6, 8], "modul": [0, 1, 3, 4, 6, 8], "search": [5, 6, 8], "page": 8, "test": [0, 7], "packag": [8, 11], "subpackag": [], "util": [0, 3, 4, 5, 8, 9, 11], "submodul": [], "gpu": [0, 8, 11], "content": [], "conftest": [], "adapt": [0, 11], "comput": [0, 1, 2, 3, 5, 8, 11], "mix": 0, "multipol": [0, 9], "method": [0, 4, 8, 11], "thi": [0, 1, 2, 3, 4, 5, 7, 10, 11], "microlens": [1, 3, 5, 7, 8, 11], "default": [1, 2, 3, 4, 5, 6, 10, 11], "fast": [0, 1, 6, 8, 11], "hexadecapol": [0, 2, 10, 11], "approxim": [0, 2, 5, 10, 11], "select": [0, 2, 5], "invok": [], "full": [0, 1, 10, 11], "finit": [0, 2, 5, 8], "sourc": [0, 1, 2, 6, 7, 8, 9], "integr": [0, 1, 6, 11], "caustic": [0, 3, 8], "when": [0, 1, 2, 3, 4, 10, 11], "requir": [0, 3, 11], "accuraci": [0, 10, 11], "microjax": [0, 1, 2, 3, 4, 5, 6, 7, 10, 11], "inverse_rai": [0, 8, 11], "mag_binari": [0, 8, 11], "w_point": [0, 8], "arrai": [0, 1, 2, 3, 4, 5, 6, 8, 11], "rho": [0, 2, 8, 11], "float": [0, 1, 2, 4, 5], "r_resolut": [0, 10, 11], "int": [0, 2, 3, 4, 6], "1000": [0, 8, 10], "th_resolut": [0, 10, 11], "u1": [0, 2], "0": [0, 1, 2, 5, 6, 7, 8, 11], "delta_c": 0, "01": [0, 8, 11], "nlimb": [0, 11], "500": 0, "bins_r": 0, "50": [0, 11], "bins_th": 0, "120": 0, "margin_r": 0, "1": [0, 1, 2, 3, 4, 5, 6, 7, 8], "margin_th": 0, "max_full_cal": [0, 10, 11], "chunk_siz": [0, 10, 11], "100": [0, 4], "param": [0, 2, 3], "binari": [0, 2, 3, 7, 8], "len": [0, 2, 3, 6, 7, 8, 11], "solv": [0, 3, 5, 6], "paramet": [0, 1, 2, 3, 4, 5, 6, 8], "follow": [2, 7, 10], "underli": [], "The": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11], "us": [0, 2, 3, 4, 5, 7, 8, 10, 11], "proxim": 0, "plu": [], "planetari": 0, "check": 10, "small": [0, 1, 4, 5, 11], "mass": [0, 3, 8, 11], "ratio": [0, 3, 8, 11], "return": [0, 1, 2, 3, 4, 5, 6, 11], "magnif": [0, 2, 3, 7, 8], "per": [1, 4, 11], "input": [1, 3, 5, 6, 11], "time": [5, 8, 11], "posit": [1, 3, 5, 6, 11], "mag_tripl": [0, 11], "tripl": [0, 2, 3, 7, 8], "simpl": 1, "linear": [0, 1, 2, 5], "fit": [1, 10, 11], "photometri": 1, "provid": [1, 3, 4, 5, 6, 7, 11], "jax": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11], "friendli": [1, 3, 4, 5], "weight": 1, "least": 1, "squar": 1, "neg": 1, "log": 1, "nll": 1, "under": [1, 5], "gaussian": 1, "model": [1, 11], "two": [1, 6], "variant": 1, "ar": [0, 1, 3, 4, 5, 6, 10, 11], "implement": [1, 2, 3, 4], "nll_ulen": 1, "path": 1, "diagon": 1, "observ": [1, 5], "nois": 1, "prior": 1, "blend": [1, 11], "flux": [1, 11], "nll_ulens_gener": 1, "rank": 1, "covari": 1, "arbitrari": 1, "mean": [1, 5, 6], "all": [0, 1, 2, 3, 4, 6, 11], "routin": [0, 1, 3, 5, 10, 11], "oper": [1, 3], "jnp": [1, 4, 7, 8, 11], "ndarrai": 1, "differenti": [1, 4, 5, 8, 10, 11], "make": [1, 4, 11], "them": [1, 10, 11], "suitabl": 1, "gradient": [1, 3, 4, 8], "base": [1, 4, 5, 11], "optim": [1, 6, 8], "infer": [1, 5, 8, 11], "linear_chi2": 1, "x": [0, 1, 3, 5, 6, 11], "y": [0, 1, 3, 6, 11], "err": 1, "union": [1, 5], "tupl": [1, 2, 3, 5], "b": [1, 6], "chi": 1, "perform": [1, 3, 11], "close": 1, "form": [1, 3], "independ": 1, "error": [1, 5, 8, 11], "If": [1, 5, 6, 11], "ani": [0, 1, 2, 11], "entri": [1, 5, 6, 7], "i": [0, 1, 3, 4, 5, 6, 7, 8, 11], "point": [1, 2, 5, 6, 7, 8, 9, 10], "treat": [1, 6, 11], "unweight": 1, "shape": [0, 1, 2, 3, 4, 5], "n": [1, 4, 5], "predictor": 1, "valu": [0, 1, 3, 4, 5, 6, 10, 11], "respons": 1, "option": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11], "standard": [1, 11], "deviat": 1, "A": [1, 10, 11], "scalar": [1, 3, 5], "broadcast": [1, 5, 11], "zero": [1, 4, 6], "replac": [0, 1, 6, 11], "best": [1, 8], "slope": 1, "intercept": 1, "ae": 1, "chi2": 1, "evalu": [0, 1, 2, 3, 5], "note": [0, 1, 2, 3, 5, 8], "solut": 1, "minim": [1, 10], "sum_i": 1, "w_i": 1, "y_i": 1, "x_i": 1, "2": [1, 2, 3, 5, 7, 8], "err_i": 1, "els": 1, "m": [1, 7, 10], "sigma2_ob": 1, "sigma2_f": 1, "sigma2_fb": 1, "assum": [1, 11], "f": [1, 3], "fb": 1, "c": [1, 10], "diag": 1, "varianc": 1, "over": [1, 2, 3, 5, 6, 11], "done": 1, "analyt": [1, 8], "yield": 1, "margin": [0, 1], "design": 1, "matrix": [1, 5, 7, 10], "column": 1, "m_f": 1, "where": [1, 3, 5, 11], "term": [1, 2, 11], "constant": 1, "captur": 1, "type": [0, 1, 3, 4, 5, 6], "express": 1, "equal": 1, "5": [1, 5, 7, 11], "mahalanobi": 1, "lambda": 1, "t": [1, 5, 8, 11], "mu": [1, 2, 11], "gener": [1, 3], "non": [1, 6], "an": [0, 1, 5, 7, 10, 11], "result": [0, 1, 6], "after": [1, 6], "out": [1, 8, 11], "map": [1, 3, 5], "symmetr": [1, 5], "definit": 1, "defin": [1, 5], "posterior": 1, "core": 3, "gravit": 3, "up": [3, 6, 8], "three": [3, 11], "lens": [0, 2, 3, 8], "lens_eq": 3, "complex": [0, 2, 3, 4, 6, 8, 11], "equat": [3, 5], "imag": [2, 3, 6, 8, 10, 11], "plane": [0, 3, 5, 11], "coordin": [0, 2, 5, 11], "z": [2, 3], "w": [3, 7, 11], "lens_eq_det_jac": 3, "determin": [3, 11], "jacobian": 3, "through": [2, 3, 7, 8, 10, 11], "det": 3, "j": [3, 11], "critical_and_caustic_curv": [3, 8], "critic": [3, 8], "curv": [0, 3, 8, 11], "_images_point_sourc": [2, 3], "given": [3, 4], "": [0, 3, 5, 7, 8, 11], "correspond": [0, 3], "polynomi": [3, 8, 9, 10, 11], "_images_point_source_sequenti": 3, "helper": [3, 6, 8], "track": [3, 6], "across": [3, 6, 11], "sequenc": 3, "reus": [0, 3, 11], "previou": 3, "root": [3, 4], "initi": [3, 4, 5], "mag_point_sourc": [3, 7, 8, 11], "total": 3, "sum": [2, 3, 11], "function": [5, 11], "written": [], "compat": [3, 11], "jit": [3, 5, 8, 10], "vector": [4, 5], "batch": [0, 3, 4, 8, 11], "appropri": [3, 11], "number": [0, 2, 3, 4, 5, 11], "encod": 3, "2d": 3, "convent": [], "configur": [0, 2, 3, 11], "mid": [2, 3], "system": [2, 3, 8, 10, 11], "coeffici": [0, 2, 3, 4], "construct": [3, 4, 5, 11], "shift": [3, 5], "center": [3, 5, 8, 11], "handl": [3, 11], "invers": [3, 8, 9, 10, 11], "intern": [3, 5], "necessari": [], "refer": [0, 3, 5, 7], "bartol": 3, "mit": 3, "licens": 3, "origin": 3, "inspir": 3, "some": [3, 10], "modifi": 3, "here": [0, 3, 10], "extend": [3, 8], "support": [3, 4], "point_sourc": [2, 3, 7, 8, 11], "npt": [3, 8], "200": 3, "nlens": [2, 3, 7, 8, 11], "sampl": [0, 3, 5, 6, 7, 10, 11], "unit": [0, 2, 3, 5, 8, 11], "circl": 3, "3": [2, 3, 5, 7, 11], "addit": [0, 2, 3, 11], "separ": [0, 3, 8, 11], "q": [0, 3, 5, 7, 8, 11], "m2": [3, 8, 11], "m1": [3, 8, 11], "we": [3, 10], "e1": [2, 3], "q3": [0, 3, 11], "third": [3, 11], "r3": [0, 2, 3, 11], "radiu": [0, 2, 3, 8, 11], "psi": [0, 3, 5, 11], "angl": [3, 5, 8, 11], "e2": [2, 3], "z_cr": 3, "nbranch": [], "branch": [2, 3, 5], "order": [4, 6, 8], "contigu": [], "z_ca": 3, "via": [2, 4, 10, 11], "For": [2, 3, 4, 11], "singl": [5, 10], "output": [0, 2, 3, 4, 5], "from": [0, 3, 4, 5, 7, 8, 11], "consist": [0, 3], "rest": 3, "librari": [3, 8], "like": [5, 8], "depend": [0, 3, 8], "half": 3, "fraction": 3, "second": [], "have": [0, 3, 10], "real": [3, 4, 11], "axi": [5, 6, 11], "distanc": 11, "r": 5, "respect": [], "exp": [], "same": [0, 2, 3, 5, 11], "give": 11, "arithmet": 3, "propag": [3, 11], "expect": [2, 3, 10], "each": [3, 5, 6, 11], "none": 4, "com": 7, "appli": [2, 3], "builder": [], "valid": [2, 3], "finder": 4, "ehrlich": 4, "aberth": 4, "version": [4, 10], "ea": 4, "iter": [4, 5, 6], "find": 4, "polyv": 4, "lax": 4, "while_loop": 4, "earli": 4, "stop": 4, "toler": 4, "implicit": [4, 10, 11], "custom_jvp": 4, "revers": 4, "forward": [0, 4, 10], "ad": [0, 4, 5], "robust": 4, "regardless": 4, "deriv": [4, 5, 11], "precomput": [4, 5], "avoid": [4, 6, 10], "everi": [4, 7, 11], "step": [4, 5, 6], "relianc": 4, "polyd": 4, "nearli": 4, "tini": 4, "imaginari": [4, 11], "part": [4, 11], "threshold": 4, "10": [4, 8, 11], "tol": 4, "pure": [4, 5], "present": [4, 6], "remain": [4, 7, 10, 11], "fulli": [4, 11], "ill": 4, "condit": 4, "case": [4, 11], "e": [4, 5, 7, 8], "g": [4, 8, 11], "multipl": [4, 11], "can": [2, 4, 5, 7, 11], "slow": [4, 8, 11], "down": [4, 11], "fall": [4, 10], "back": [4, 10], "newton": [4, 5], "denomin": 4, "get": [4, 8], "too": 4, "improv": [4, 10, 11], "stabil": [4, 7, 11], "poly_solv": 4, "poly_root": 4, "coeff": 4, "custom_init": 4, "bool": 4, "fals": 4, "roots_init": 4, "pass": [4, 5, 10], "true": [4, 5, 7, 8, 11], "feed": [0, 4], "custom": [4, 8], "guess": [4, 5], "unspecifi": 4, "poly_roots_ea_multi": 4, "coeffs_matrix": 4, "initial_roots_matrix": 4, "1e": [4, 7], "12": 4, "max_it": 4, "absolut": [2, 4, 5], "updat": [4, 7, 8, 11], "poly_roots_ea": 4, "maximum": [0, 4, 6, 11], "_default_max_it": 4, "annual": [5, 11], "parallax": [5, 8, 11], "built": 8, "earth": 5, "project": [5, 11], "correct": 2, "equatori": 5, "icr": [5, 8, 11], "frame": 5, "autodiff": 8, "lightweight": [], "fix": [5, 7, 10], "numer": [7, 10], "need": [0, 5, 10, 11], "peri_vern": 5, "tref": 5, "perihelion": 5, "vernal": 5, "equinox": 5, "epoch": 5, "nearest": [5, 6], "getpsi": 5, "phi": 5, "ecc": 5, "kepler": 5, "eccentr": 5, "anomali": 5, "prepare_projection_basi": 5, "rotaxis_deg": 5, "psi_offset": 5, "ra": 5, "dec": 5, "build": [0, 5, 10], "orbit": [5, 8, 11], "rotat": 5, "sky": 5, "north": 5, "east": 5, "basi": 5, "project_earth_posit": 5, "tperi": 5, "period": 5, "sun": 5, "onto": 5, "target": 5, "tangent": 5, "set_parallax": 5, "tvernal": 5, "quantiti": [2, 5], "local": 5, "veloc": 5, "around": 5, "compute_parallax": 5, "pien": 5, "piee": 5, "parallax_param": 5, "offset": 5, "add": [5, 11], "dimensionless": 5, "tau": [5, 8, 11], "impact": [5, 8, 11], "u": 5, "jd": 5, "2450000": 5, "unless": [], "state": [], "otherwis": 6, "right": 5, "ascens": 5, "declin": 5, "degre": 5, "orthonorm": 5, "orthogon": 5, "line": [5, 11], "sight": 5, "lo": [], "obliqu": 5, "23": 5, "44": 5, "deg": [], "0167": 5, "sider": 5, "year": 5, "365": 5, "25636": 5, "dai": [5, 8, 11], "hand": [], "z_eq": [], "pole": [], "increas": [10, 11], "tm": [], "dtn": 5, "um": [], "u0": [8, 11], "dum": 5, "t0": [8, 11], "te": [8, 11], "exampl": [5, 7, 8, 10, 11], "8000": [], "266": [], "4168": [], "29": [], "0078": [], "linspac": [7, 8, 11], "meeu": [], "astronom": [], "algorithm": 6, "2nd": [], "ed": [], "willmann": [], "bell": [], "seidelmann": [], "p": [], "k": [], "explanatori": [], "supplement": [], "almanac": [], "gould": [], "2004": [], "resolut": [], "microlen": [], "degeneraci": [], "apj": [], "606": [], "319": [], "produc": 5, "induc": 5, "should": [5, 11], "which": [5, 6], "signal": 5, "amplitud": [2, 5], "direct": [5, 11], "match": [3, 5, 6, 7, 10], "motion": [5, 8, 11], "remov": 5, "isol": 5, "contribut": [2, 5], "sin": [5, 8, 11], "raphson": 5, "empir": 5, "work": [5, 7, 8, 10], "radian": [0, 5, 8, 11], "mai": [0, 2, 5, 11], "85": 5, "well": 5, "moder": 5, "without": [5, 11], "count": [0, 5], "keep": [0, 5, 10, 11], "control": [5, 11], "flow": [5, 8], "closest": [5, 6, 11], "pre": 5, "tabul": 5, "accept": [3, 5], "both": [3, 5, 10], "julian": 5, "date": 5, "larger": [5, 11], "than": 5, "2_450_000": 5, "subtract": 5, "so": [0, 5, 11], "compar": 5, "against": [5, 6], "tabl": [0, 5], "below": [5, 7, 8, 11], "neighbor": 5, "interpol": [0, 5], "found": 5, "rule": 5, "pair": 5, "2458000": 5, "eclipt": 5, "tilt": 5, "between": [0, 5, 6, 11], "align": [5, 11], "celesti": 5, "its": 5, "ellipt": 5, "1d": 5, "stack": [0, 5, 7, 10], "q_north": 5, "q_east": 5, "toward": 5, "dt": 5, "includ": [5, 6], "differ": 5, "either": 5, "automat": [5, 11], "anchor": 5, "auto": [5, 8], "qne0": 5, "vne0": 5, "element": [5, 6], "d": 5, "width": 5, "reduc": [5, 11], "truncat": 5, "preserv": [0, 5], "first_nonzero": 6, "first_zero": 6, "last_nonzero": 6, "match_point": 6, "indic": 6, "permut": 6, "guarante": [], "elementwis": [], "assign": 6, "problem": [6, 10, 11], "array_lik": [], "specifi": 11, "max_zero_avoid": 6, "mean_zero_avoid": 6, "min_zero_avoid": 6, "minimum": 6, "sparse_argsort": 6, "collect": [], "contributor": 8, "power": [], "user": [10, 11], "who": [], "want": 11, "run": [7, 8, 11], "rebuild": [], "instal": [8, 10], "first": [0, 6], "pip": [7, 10], "dev": 7, "cpu": [0, 7, 8, 10], "pytest": [], "specif": [], "opt": [], "On": 10, "cuda": [7, 8, 10], "capabl": [], "machin": [], "skip": 6, "cannot": 8, "see": [0, 7, 8], "devic": [7, 10, 11], "No": [], "environ": [8, 10], "variabl": 10, "though": 7, "jax_platform": 10, "help": 10, "you": [0, 7, 10, 11], "runtim": 10, "sphinx": [], "live": [], "docs_src": [], "render": [], "html": [], "commit": [], "doc": [], "conveni": [], "cd": 7, "site": [], "appear": 11, "publish": 7, "github": [7, 10], "push": [], "file": [], "wire": [], "workflow": [8, 11], "ruff": [], "lint": [], "format": [], "befor": [10, 11], "chang": 11, "enabl": [7, 8, 11], "64": [7, 11], "bit": [7, 11], "mode": [7, 11], "dure": 0, "reproduc": 10, "python": [7, 10, 11], "py": 7, "import": [7, 8, 11], "config": [7, 8, 11], "jax_enable_x64": [7, 8, 10, 11], "open": 10, "issu": 10, "start": [0, 8, 11], "discuss": [], "encount": [], "propos": [], "section": 8, "set": [0, 3, 6, 10, 11], "ensur": 10, "talk": [], "your": [7, 10, 11], "avail": [], "hardwar": 11, "9": 7, "newer": 7, "jaxlib": [7, 10], "acceler": [0, 7, 8], "onli": [0, 10, 11], "rocm": [7, 10], "numpi": [7, 8, 10, 11], "scipi": 6, "pypi": 7, "recommend": 7, "microjaxx": 7, "name": 7, "upgrad": 0, "latest": 7, "releas": 7, "develop": [], "git": 7, "clone": 7, "http": 7, "shotamiyazaki94": [7, 8], "offici": [7, 10], "guid": 7, "wheel": 7, "verifi": 8, "detect": 7, "correctli": [], "print": [7, 10, 11], "__version__": [7, 10], "precis": 10, "continu": 11, "usag": [0, 7, 8, 10], "snippet": [7, 10, 11], "review": [], "plan": 7, "suit": [], "toolkit": 8, "top": 8, "contour": [], "trajectori": [0, 8, 9], "readi": 8, "likelihood": [0, 8, 9, 11], "companion": [], "readm": [], "walk": [7, 11], "common": [7, 8, 10], "while": [0, 6], "link": [], "detail": [2, 7], "public": 7, "next": 8, "light": [0, 11], "tip": [], "code": 10, "style": [], "ask": [], "question": [], "rai": [8, 9, 10, 11], "lightcurv": [8, 9, 11], "solver": [0, 8, 9, 10, 11], "highlight": [], "past": [], "notebook": 11, "script": [10, 11], "onc": [], "notat": [], "1j": [0, 7, 8, 11], "05": 11, "05j": 11, "centr": 10, "shoot": [8, 10, 11], "fallback": 0, "02": [8, 11], "alpha": [8, 11], "30": 8, "deg2rad": [8, 11], "800": [], "y1": [8, 11], "co": [8, 11], "y2": [8, 11], "dtype": [8, 11], "750": [], "400": [], "mani": [10, 11], "tune": [], "trade": 10, "execut": [], "speed": [], "abov": 11, "adjust": [10, 11], "memori": [0, 8, 11], "budget": [], "contain": 3, "instanc": [], "expos": [], "straight": 11, "api": [7, 11], "global": [], "care": [], "about": [], "To": 11, "just": [], "those": 3, "vmap": [0, 11], "vectoris": [], "dict": 3, "n_branch": 3, "collaps": 3, "store": 3, "combin": [0, 8, 11], "deliv": [0, 8], "accur": [0, 8], "cost": [0, 11], "manag": 0, "kei": 0, "export": 0, "estim": 0, "everywher": [0, 8], "fail": 0, "heurist": 0, "hybrid": 0, "trigger": 0, "decid": 0, "chunk": 0, "expens": 0, "call": [0, 11], "balanc": 0, "occup": 0, "limb": [0, 2, 8, 11], "darken": [0, 2, 8], "awar": [0, 8], "switch": 0, "seamlessli": 0, "uniform": [0, 2], "profil": 0, "toggl": 0, "share": [0, 6], "infrastructur": 0, "knob": [0, 11], "behav": 0, "downstream": 0, "miyazaki": [0, 8], "kawahara": [0, 8], "prep": 0, "descript": 0, "forthcom": 0, "argument": [0, 11], "mirror": [0, 11], "lower": [0, 10], "level": [0, 7], "extended_sourc": 0, "along": [0, 6, 11], "trail": 0, "angular": [0, 11], "einstein": [0, 2, 8, 11], "radial": [0, 11], "quadratur": 0, "panel": 0, "azimuth": 0, "contract": 0, "factor": 0, "ring": 0, "bin": 0, "polar": 0, "mesh": 0, "structur": 0, "radii": [0, 11], "domain": 0, "size": 0, "fed": 0, "keyword": [0, 11], "guard": 0, "veri": [0, 8, 10], "fire": 0, "recomput": 0, "mag_uniform": 0, "mag_limb_dark": 0, "lazili": 0, "block_until_readi": 0, "synchronis": 0, "asynchron": 0, "context": [0, 11], "logic": 0, "current": 0, "yet": 0, "been": [0, 11], "specialis": 0, "receiv": 0, "must": [0, 11], "suppli": [0, 11], "alwai": 0, "patch": 0, "cusp": 0, "reson": 0, "higher": [0, 8], "reach": 0, "converg": 0, "sketch": [], "layout": [], "orient": [], "yourself": [], "interfac": [], "hous": [], "machineri": [], "driver": 10, "offer": [], "marginalis": [8, 11], "drop": 11, "numpyro": [], "black": [], "box": [], "optimis": [], "etc": [], "compos": [8, 11], "photometr": [], "heavi": [], "kernel": [], "workload": [], "benefit": [], "larg": [], "stai": [], "resid": 11, "establish": [], "baselin": 11, "re": [], "previous": [], "warm": [], "graph": [], "compact": [], "dimension": 6, "throughout": [], "semant": [], "lead": 11, "ax": 11, "concret": [], "brows": [], "callabl": [], "signatur": [], "regener": [], "group": [], "platform": [7, 10], "visibl": [], "forc": 10, "determinist": 6, "xla_flag": [], "xla_gpu_deterministic_op": [], "artifact": [], "autom": [], "deploy": [], "consid": [], "ci": [], "explicit": [], "tidi": [], "static": [], "hint": [], "gradual": 10, "being": [], "pyright": [], "product": 11, "wrap": 11, "trace_funct": [], "start_trac": [], "trace": 10, "viewabl": [], "tensorboard": [], "experi": [], "benchmark": [], "repres": [], "interact": [], "strongli": [], "thread": [], "pleas": [], "inform": 10, "saniti": [], "11": [], "compil": [10, 11], "matplotlib": [7, 10], "seaborn": [7, 10], "plot": [7, 10], "recent": [], "stabl": [], "even": 7, "pick": 6, "cleanli": 7, "smoke": 7, "concept": [], "architectur": [], "explain": 11, "how": [10, 11], "togeth": 10, "troubleshoot": [7, 8], "list": 7, "pitfal": 7, "quick": 7, "hmc": 8, "vi": 8, "512": [], "pi": [], "4": 11, "toi": [], "mag": 11, "001": [], "explor": 8, "dig": 8, "prerequisit": 8, "practic": 8, "my": 8, "stall": 8, "still": 8, "stuck": 8, "strategi": [], "data": [], "further": 11, "read": [], "tool": [], "most": [10, 11], "report": 10, "new": 10, "summaris": 10, "suggest": 10, "doubl": 10, "xla_python_client_prealloc": 10, "temporarili": 10, "multi": 10, "confirm": [7, 10], "access": 10, "nvidia": 10, "smi": 10, "equival": [6, 10], "scale": [], "more": 8, "process": 11, "launch": [], "decreas": [], "turn": 10, "sensit": 10, "take": 10, "shorten": 10, "length": 10, "repeat": 10, "recompil": 10, "pull": 10, "extra": [], "manual": [10, 11], "intend": 11, "demo": 10, "happi": 10, "debug": 10, "document": 10, "chapter": 11, "relev": [], "95": 11, "5e": 11, "40": 11, "60": 11, "1024": 11, "768": [], "128": [], "limit": 11, "shrink": [], "challeng": [], "6": [], "210": 11, "functool": 11, "partial": 11, "grad": 11, "def": 11, "loglik": [], "model_flux": [], "data_flux": 11, "loglike_jit": [], "dloglike_dq": [], "block": 11, "miss": 6, "peak": [], "interv": [], "utilis": [], "cach": [], "instead": 11, "xla": 8, "acceral": 8, "icir": [], "n_point": 8, "mag_p": 8, "mag_ext": 8, "crit": 8, "cau": 8, "also": [8, 10, 11], "copyright": 8, "2025": 8, "shota": 8, "maintain": 8, "hajim": 8, "hajimekawahara": 8, "other": [2, 8, 11], "effect": 8, "prepar": 7, "visual": 7, "Or": 7, "better": 7, "alreadi": 11, "one": 11, "grid": [10, 11], "constrain": [], "spend": [], "bodi": 11, "As": [], "rais": [10, 11], "setup": 8, "what": 11, "doe": [6, 11], "goal": 11, "copi": 11, "pasteabl": 11, "own": 11, "session": 11, "everyth": 11, "place": 11, "easier": 11, "stabilis": 11, "cell": 11, "ha": 11, "restart": 11, "rerun": 11, "infinitesim": 11, "assembl": 11, "associ": 11, "00": 11, "10j": 11, "02j": 11, "introduc": 11, "sweep": 11, "typic": 2, "rang": [], "secondari": [], "primari": [], "chosen": [], "littl": [], "longer": [], "becaus": [], "rectilinear": 11, "feel": 11, "free": 11, "sampler": 11, "approach": 11, "stick": 11, "hit": 11, "multipli": 11, "intrins": 11, "lookup": [], "256": [], "dictat": [], "long": [], "end": [], "cap": 10, "oscil": [], "allow": [], "tandem": [], "calcul": 11, "describ": 11, "explicitli": 11, "mags_tripl": 11, "guidelin": 11, "often": 11, "intric": [], "possibli": [], "excess": [], "pressur": 10, "measur": 11, "counter": 11, "clockwis": 11, "jacrev": 11, "load": 11, "example_lightcurv": 11, "npy": 11, "forward_model": 11, "instrument": 11, "forward_jit": 11, "neg_log_lik": 11, "especi": 11, "simultan": 11, "uncertainti": 11, "beyond": [6, 11], "piec": 11, "keplerian": [], "progress": [], "docstr": [], "statu": [], "resampl": [], "These": 11, "compon": 11, "significantli": 11, "dimens": [], "reli": [], "whenev": [], "erod": [], "nuisanc": 11, "autocorrel": 11, "divis": 11, "accord": 11, "It": [6, 11], "upper": 11, "parallel": 11, "exce": 11, "caus": 11, "smaller": [10, 11], "safer": 11, "capac": 11, "annular": 11, "sector": 11, "In": 11, "do": [10, 11], "catastroph": 11, "mag_hexadecapol": 2, "z_mask": 2, "locat": 2, "n_imag": 2, "boolean": 2, "mask": 2, "obtain": 2, "quadrupol": 2, "residu": 2, "diagnost": 2, "gaug": 2, "insuffici": 2, "cassan": 2, "et": 2, "al": 2, "2017": 2, "moment": 2, "w_k": 2, "gamma": 2, "sign": 5, "last": 6, "greedi": 6, "neighbour": 6, "unus": 6, "suffici": 6, "One": 6, "candid": 6, "argsort": 6, "sort": 6, "nan": 6, "trapz_zero_avoid": 6, "tail_idx": 6, "trapezoid": 6, "omit": 6, "final": 6, "segment": 6, "reliabl": 6, "trim": 10, "cut": 10, "demand": 10, "crash": 10, "underutilis": 10, "bound": 10, "off": 10, "revert": 10}, "objects": {"microjax.inverse_ray": [[0, 0, 0, "-", "lightcurve"]], "microjax.inverse_ray.lightcurve": [[0, 1, 1, "", "mag_binary"], [0, 1, 1, "", "mag_triple"]], "microjax": [[1, 0, 0, "-", "likelihood"], [2, 0, 0, "-", "multipole"], [3, 0, 0, "-", "point_source"], [4, 0, 0, "-", "poly_solver"], [5, 0, 0, "-", "trajectory"], [6, 0, 0, "-", "utils"]], "microjax.likelihood": [[1, 1, 1, "", "linear_chi2"], [1, 1, 1, "", "nll_ulens"], [1, 1, 1, "", "nll_ulens_general"]], "microjax.multipole": [[2, 1, 1, "", "mag_hexadecapole"]], "microjax.point_source": [[3, 1, 1, "", "critical_and_caustic_curves"], [3, 1, 1, "", "lens_eq"], [3, 1, 1, "", "lens_eq_det_jac"], [3, 1, 1, "", "mag_point_source"]], "microjax.poly_solver": [[4, 1, 1, "", "poly_roots"], [4, 1, 1, "", "poly_roots_EA_multi"]], "microjax.trajectory": [[5, 1, 1, "", "compute_parallax"], [5, 1, 1, "", "getpsi"], [5, 1, 1, "", "peri_vernal"], [5, 1, 1, "", "prepare_projection_basis"], [5, 1, 1, "", "project_earth_position"], [5, 1, 1, "", "set_parallax"]], "microjax.utils": [[6, 1, 1, "", "first_nonzero"], [6, 1, 1, "", "first_zero"], [6, 1, 1, "", "last_nonzero"], [6, 1, 1, "", "match_points"], [6, 1, 1, "", "max_zero_avoiding"], [6, 1, 1, "", "mean_zero_avoiding"], [6, 1, 1, "", "min_zero_avoiding"], [6, 1, 1, "", "sparse_argsort"], [6, 1, 1, "", "trapz_zero_avoiding"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "microjax": 8, "": [], "document": [], "indic": 8, "tabl": 8, "test": [], "packag": [], "subpackag": [], "submodul": [], "conftest": [], "modul": [], "content": [], "util": [1, 6], "gpu": 10, "invers": 0, "rai": 0, "lightcurv": 0, "likelihood": 1, "multipol": 2, "point": [3, 11], "sourc": [3, 11], "polynomi": 4, "solver": 4, "design": [0, 4], "highlight": [0, 4, 8], "note": 4, "numer": 4, "behavior": 4, "trajectori": [5, 11], "function": [3, 6], "convent": 3, "sign": [], "develop": [], "suit": [], "code": [], "style": [], "where": [], "ask": [], "question": [], "get": 7, "start": 7, "requir": [], "instal": 7, "first": [], "check": [], "next": 7, "step": 11, "guid": [8, 11], "api": [8, 9], "refer": [8, 9], "usag": 11, "magnif": 11, "extend": [], "light": [], "curv": [], "helper": 11, "tip": [], "coordin": 3, "workflow": 0, "outlin": 0, "concept": [], "architectur": [], "core": [], "execut": [], "model": [], "accuraci": [], "strategi": [], "kei": [], "data": [], "further": [], "read": [], "tool": [], "profil": [], "support": [], "prerequisit": 7, "verifi": 7, "environ": 7, "up": 7, "quick": 8, "peek": 8, "intern": [], "contribut": [], "troubleshoot": 10, "jax": 10, "cannot": 10, "see": 10, "my": 10, "mag_binari": 10, "i": 10, "slow": 10, "run": 10, "out": 10, "memori": 10, "gradient": 10, "comput": 10, "stall": 10, "import": 10, "error": 10, "option": 10, "depend": 10, "still": 10, "stuck": 10, "finit": 11, "binari": 11, "lens": 11, "tripl": 11, "autodiff": 11, "jit": 11, "best": 11, "practic": 11, "licens": 8, "attribut": 8, "common": 11, "setup": 11, "mag_point_sourc": [], "paramet": 11, "1": 11, "build": 11, "2": 11, "evalu": 11, "fine": 11, "tune": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Usage Guide": [[11, "usage-guide"]], "Common setup": [[11, "common-setup"]], "Point-source magnification": [[11, "point-source-magnification"]], "Step-by-step": [[11, "step-by-step"]], "Finite-source binary lenses": [[11, "finite-source-binary-lenses"]], "1. Build the trajectory": [[11, "build-the-trajectory"]], "2. Evaluate the magnification": [[11, "evaluate-the-magnification"]], "Fine-tuning parameters": [[11, "fine-tuning-parameters"]], "Triple lenses": [[11, "triple-lenses"]], "Autodiff and jit": [[11, "autodiff-and-jit"]], "Trajectory helpers": [[11, "trajectory-helpers"]], "Best practices": [[11, "best-practices"]], "microJAX": [[8, "microjax"]], "Highlights": [[8, "highlights"]], "Quick peek": [[8, "quick-peek"]], "Guides": [[8, null]], "API Reference": [[8, null], [9, "api-reference"]], "Indices and tables": [[8, "indices-and-tables"]], "References": [[8, "references"]], "License & Attribution": [[8, "license-attribution"]], "Inverse-Ray Lightcurve": [[0, "module-microjax.inverse_ray.lightcurve"]], "Design highlights": [[0, "design-highlights"], [4, "design-highlights"]], "Workflow outline": [[0, "workflow-outline"]], "Likelihood Utilities": [[1, "module-microjax.likelihood"]], "Multipole": [[2, "module-microjax.multipole"]], "Point Source": [[3, "module-microjax.point_source"]], "Functions": [[3, "functions"]], "Coordinate conventions": [[3, "coordinate-conventions"]], "Polynomial Solver": [[4, "module-microjax.poly_solver"]], "Notes on numerical behavior": [[4, "notes-on-numerical-behavior"]], "Trajectories": [[5, "module-microjax.trajectory"]], "Utility Functions": [[6, "module-microjax.utils"]], "Getting Started": [[7, "getting-started"]], "Prerequisites": [[7, "prerequisites"]], "Installation": [[7, "installation"]], "Verify the environment": [[7, "verify-the-environment"]], "Up next": [[7, "up-next"]], "Troubleshooting": [[10, "troubleshooting"]], "JAX cannot see my GPU": [[10, "jax-cannot-see-my-gpu"]], "mag_binary is slow or runs out of memory": [[10, "mag-binary-is-slow-or-runs-out-of-memory"]], "Gradient computations stall": [[10, "gradient-computations-stall"]], "Import errors for optional dependencies": [[10, "import-errors-for-optional-dependencies"]], "Still stuck?": [[10, "still-stuck"]]}, "indexentries": {}})