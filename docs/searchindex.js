Search.setIndex({"docnames": ["api/caustics_lightcurve", "api/inverse_ray_lightcurve", "api/likelihood", "api/multipole", "api/point_source", "api/poly_solver", "api/trajectory", "api/utils", "getting_started", "index", "modules", "troubleshooting", "usage"], "filenames": ["api/caustics_lightcurve.rst", "api/inverse_ray_lightcurve.rst", "api/likelihood.rst", "api/multipole.rst", "api/point_source.rst", "api/poly_solver.rst", "api/trajectory.rst", "api/utils.rst", "getting_started.rst", "index.rst", "modules.rst", "troubleshooting.rst", "usage.rst"], "titles": ["Caustics Lightcurve", "Inverse-Ray Lightcurve", "Likelihood Utilities", "Multipole", "Point Source", "Polynomial Solver", "Trajectories", "Utility Functions", "Getting Started", "microJAX", "API Reference", "Troubleshooting", "Usage Guide"], "terms": {"index": [7, 9], "modul": [1, 2, 4, 5, 7, 9], "search": [6, 7, 9], "page": 9, "test": [0, 1, 8], "packag": [9, 12], "subpackag": [], "util": [1, 4, 5, 6, 9, 10, 12], "submodul": [], "gpu": [1, 9, 12], "content": [], "conftest": [], "adapt": [0, 1, 12], "comput": [1, 2, 3, 4, 6, 9, 12], "mix": [], "multipol": [0, 1, 10], "method": [5, 9, 12], "thi": [0, 1, 2, 3, 4, 5, 6, 8, 11, 12], "microlens": [2, 4, 6, 8, 9, 12], "default": [0, 2, 3, 4, 5, 6, 7, 11, 12], "fast": [0, 2, 7, 9, 12], "hexadecapol": [1, 3, 11, 12], "approxim": [1, 3, 6, 11, 12], "select": [0, 1, 3, 6], "invok": 1, "full": [0, 1, 2, 11, 12], "finit": [0, 1, 3, 6, 9], "sourc": [0, 1, 2, 3, 7, 8, 9, 10], "integr": [0, 1, 2, 7, 12], "caustic": [1, 4, 9, 10], "when": [0, 1, 2, 3, 4, 5, 11, 12], "requir": [0, 1, 4, 12], "accuraci": [0, 1, 11, 12], "microjax": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11, 12], "inverse_rai": [1, 9, 12], "mag_binari": [1, 9, 12], "w_point": [0, 1, 9, 12], "arrai": [0, 1, 2, 3, 4, 5, 6, 7, 9, 12], "rho": [0, 1, 3, 9, 12], "float": [0, 1, 2, 3, 5, 6], "r_resolut": [1, 11, 12], "int": [0, 1, 3, 4, 5, 7], "1000": [1, 9, 11], "th_resolut": [1, 11, 12], "u1": [0, 1, 3], "0": [0, 1, 2, 3, 6, 7, 8, 9, 12], "delta_c": 1, "01": [1, 9, 12], "nlimb": [1, 12], "500": 1, "bins_r": 1, "50": [1, 12], "bins_th": 1, "120": 1, "margin_r": 1, "1": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "margin_th": 1, "max_full_cal": [1, 11, 12], "chunk_siz": [1, 11, 12], "100": [0, 1, 5], "param": [0, 1, 3, 4], "binari": [1, 3, 4, 8, 9], "len": [0, 1, 3, 4, 7, 8, 9, 12], "solv": [1, 4, 6, 7], "paramet": [0, 1, 2, 3, 4, 5, 6, 7, 9], "follow": [0, 3, 8, 11], "underli": 0, "The": [1, 2, 3, 5, 6, 7, 8, 9, 11, 12], "us": [0, 1, 3, 4, 5, 6, 8, 9, 11, 12], "proxim": [0, 1], "plu": [], "planetari": [0, 1], "check": 11, "small": [2, 5, 6, 12], "mass": [0, 1, 4, 9, 12], "ratio": [0, 1, 4, 9, 12], "return": [0, 1, 2, 3, 4, 5, 6, 7, 12], "magnif": [0, 1, 3, 4, 8, 9], "per": [0, 1, 2, 5, 12], "input": [1, 2, 4, 6, 7, 12], "time": [6, 9, 12], "posit": [0, 1, 2, 4, 6, 7, 12], "mag_tripl": [1, 12], "tripl": [0, 1, 3, 4, 8, 9], "simpl": 2, "linear": [0, 1, 2, 3, 6], "fit": [2, 11, 12], "photometri": 2, "provid": [1, 2, 4, 5, 6, 7, 8, 12], "jax": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12], "friendli": [2, 4, 5, 6], "weight": 2, "least": 2, "squar": 2, "neg": 2, "log": [2, 9], "nll": 2, "under": [2, 6, 12], "gaussian": 2, "model": [2, 12], "two": [0, 2, 7], "variant": 2, "ar": [0, 1, 2, 4, 5, 6, 7, 11, 12], "implement": [0, 2, 3, 4, 5], "nll_ulen": 2, "path": [0, 2], "diagon": 2, "observ": [2, 6], "nois": 2, "prior": 2, "blend": [2, 12], "flux": [2, 12], "nll_ulens_gener": 2, "rank": 2, "covari": 2, "arbitrari": 2, "mean": [2, 6, 7], "all": [1, 2, 3, 4, 5, 7, 12], "routin": [0, 1, 2, 4, 6, 11, 12], "oper": [2, 4], "jnp": [1, 2, 5, 8, 9, 12], "ndarrai": 2, "differenti": [2, 5, 6, 9, 11, 12], "make": [2, 5, 12], "them": [2, 11, 12], "suitabl": 2, "gradient": [2, 4, 5, 9], "base": [0, 2, 5, 6, 12], "optim": [2, 7, 9], "infer": [2, 6, 9, 12], "linear_chi2": 2, "x": [1, 2, 4, 6, 7, 12], "y": [1, 2, 4, 7, 12], "err": 2, "union": [2, 6], "tupl": [2, 3, 4, 6], "b": [2, 7, 9], "chi": 2, "perform": [2, 4, 12], "close": 2, "form": [2, 4], "independ": 2, "error": [2, 6, 9, 12], "If": [0, 2, 6, 7, 12], "ani": [1, 2, 3, 12], "entri": [0, 1, 2, 6, 7, 8], "i": [0, 1, 2, 4, 5, 6, 7, 8, 9, 12], "point": [0, 1, 2, 3, 6, 7, 8, 9, 10, 11], "treat": [2, 7, 12], "unweight": 2, "shape": [1, 2, 3, 4, 5, 6], "n": [2, 5, 6], "predictor": 2, "valu": [1, 2, 4, 5, 6, 7, 11, 12], "respons": 2, "option": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12], "standard": [2, 12], "deviat": 2, "A": [2, 11, 12], "scalar": [2, 4, 6], "broadcast": [2, 6, 12], "zero": [2, 5, 7], "replac": [1, 2, 7, 12], "best": [2, 9], "slope": 2, "intercept": 2, "ae": 2, "chi2": 2, "evalu": [0, 1, 2, 3, 4, 6], "note": [0, 1, 2, 3, 4, 6, 9, 12], "solut": [1, 2], "minim": [2, 11], "sum_i": 2, "w_i": 2, "y_i": 2, "x_i": 2, "2": [0, 1, 2, 3, 4, 6, 8, 9], "err_i": 2, "els": 2, "m": [2, 8, 11], "sigma2_ob": 2, "sigma2_f": 2, "sigma2_fb": 2, "assum": [2, 12], "f": [2, 4], "fb": 2, "c": [2, 11], "diag": 2, "varianc": 2, "over": [2, 3, 4, 6, 7, 12], "done": 2, "analyt": [2, 9], "yield": 2, "margin": [1, 2], "design": 2, "matrix": [2, 6, 8, 11], "column": 2, "m_f": 2, "where": [0, 1, 2, 4, 6, 12], "term": [2, 3, 12], "constant": 2, "captur": 2, "type": [0, 1, 2, 4, 5, 6, 7], "express": [1, 2], "equal": [2, 9], "5": [2, 6, 8, 9], "mahalanobi": 2, "lambda": 2, "t": [2, 6, 9, 12], "mu": [2, 3, 12], "gener": [2, 4], "non": [2, 7], "an": [0, 2, 6, 8, 11, 12], "result": [1, 2, 7], "after": [2, 7], "out": [2, 9, 12], "map": [2, 4, 6], "symmetr": [2, 6], "definit": 2, "defin": [1, 2, 6], "posterior": 2, "core": 4, "gravit": 4, "up": [1, 4, 7, 9], "three": [0, 4, 12], "lens": [0, 1, 3, 4, 9], "lens_eq": 4, "complex": [0, 1, 3, 4, 5, 7, 9, 12], "equat": [4, 6], "imag": [0, 1, 3, 4, 7, 9, 11, 12], "plane": [1, 4, 6, 12], "coordin": [0, 1, 3, 6, 12], "z": [3, 4], "w": [4, 8, 12], "lens_eq_det_jac": 4, "determin": [0, 4, 12], "jacobian": 4, "through": [1, 3, 4, 8, 9, 11, 12], "det": 4, "j": [4, 12], "critical_and_caustic_curv": [4, 9], "critic": [4, 9], "curv": [1, 4, 9, 12], "_images_point_sourc": [0, 1, 3, 4], "given": [0, 4, 5], "": [0, 1, 4, 6, 8, 9, 12], "correspond": 4, "polynomi": [0, 4, 9, 10, 11, 12], "_images_point_source_sequenti": 4, "helper": [0, 4, 7, 9], "track": [4, 7], "across": [4, 7, 12], "sequenc": 4, "reus": [1, 4, 12], "previou": 4, "root": [0, 4, 5], "initi": [4, 5, 6], "mag_point_sourc": [4, 8, 9, 12], "total": 4, "sum": [3, 4], "function": [1, 6, 12], "written": [], "compat": [4, 12], "jit": [4, 6, 9, 11], "vector": [5, 6], "batch": [1, 4, 5, 9, 12], "appropri": [4, 12], "number": [0, 1, 3, 4, 5, 6, 12], "encod": 4, "2d": 4, "convent": [], "configur": [0, 1, 3, 4, 12], "mid": [0, 3, 4], "system": [0, 3, 4, 9, 11, 12], "coeffici": [0, 1, 3, 4, 5], "construct": [1, 4, 5, 6, 12], "shift": [0, 1, 4, 6], "center": [0, 4, 6, 9, 12], "handl": [0, 1, 4, 12], "invers": [4, 9, 10, 11, 12], "intern": [0, 1, 4, 6], "necessari": [], "refer": [1, 4, 6, 8], "bartol": 4, "mit": 4, "licens": 4, "origin": [0, 1, 4], "inspir": 4, "some": [4, 11], "modifi": 4, "here": [1, 4, 11], "extend": [0, 4, 9], "support": [1, 4, 5], "point_sourc": [0, 1, 3, 4, 8, 9, 12], "npt": [4, 9], "200": [0, 4], "nlens": [0, 1, 3, 4, 8, 9, 12], "sampl": [0, 1, 4, 6, 7, 8, 11, 12], "unit": [0, 1, 3, 4, 6, 9, 12], "circl": 4, "3": [0, 1, 3, 4, 6, 8, 12], "addit": [0, 1, 3, 4, 12], "separ": [0, 1, 4, 9, 12], "q": [0, 1, 4, 6, 8, 9, 12], "m2": [0, 4, 9, 12], "m1": [0, 4, 9, 12], "we": [4, 11], "e1": [3, 4], "q3": [0, 1, 4, 12], "third": [0, 4, 12], "r3": [0, 1, 3, 4, 12], "radiu": [0, 1, 3, 4, 9, 12], "psi": [0, 1, 4, 6, 12], "angl": [1, 4, 6, 9, 12], "e2": [3, 4], "z_cr": 4, "nbranch": [], "branch": [0, 3, 4, 6], "order": [0, 1, 5, 7, 9], "contigu": [], "z_ca": 4, "via": [1, 3, 5, 11, 12], "For": [3, 4, 5, 12], "singl": [0, 6, 11], "output": [3, 4, 5, 6], "from": [1, 4, 5, 6, 8, 9, 12], "consist": [1, 4], "rest": 4, "librari": [4, 9], "like": [6, 9], "depend": [4, 9], "half": 4, "fraction": 4, "second": [], "have": [1, 4, 11], "real": [1, 4, 5, 9, 12], "axi": [1, 6, 7, 9, 12], "distanc": 12, "r": [6, 9], "respect": [], "exp": [], "same": [1, 3, 4, 6, 12], "give": 12, "arithmet": 4, "propag": [0, 4], "expect": [3, 4, 11], "each": [0, 1, 4, 6, 7, 12], "none": 5, "com": 8, "appli": [1, 3, 4], "builder": [], "valid": [3, 4], "finder": 5, "ehrlich": 5, "aberth": 5, "version": [5, 11], "ea": 5, "iter": [5, 6, 7], "find": 5, "polyv": 5, "lax": 5, "while_loop": 5, "earli": 5, "stop": 5, "toler": 5, "implicit": [5, 11, 12], "custom_jvp": 5, "revers": [5, 12], "forward": [0, 1, 5, 11], "ad": [5, 6], "robust": 5, "regardless": 5, "deriv": [5, 6, 12], "precomput": [5, 6], "avoid": [5, 7, 11], "everi": [0, 1, 5, 8, 12], "step": [5, 6, 7], "relianc": 5, "polyd": 5, "nearli": 5, "tini": 5, "imaginari": [5, 12], "part": [5, 12], "threshold": [1, 5], "10": [5, 9, 12], "tol": 5, "pure": [1, 5, 6], "present": [5, 7], "remain": [1, 5, 8, 11, 12], "fulli": [5, 12], "ill": 5, "condit": 5, "case": [5, 12], "e": [5, 6, 8, 9], "g": [5, 9], "multipl": 5, "can": [3, 5, 6, 8, 12], "slow": [5, 9, 12], "down": [5, 12], "fall": [0, 5, 11], "back": [0, 5, 11], "newton": [5, 6], "denomin": 5, "get": [5, 9], "too": 5, "improv": [5, 11, 12], "stabil": [5, 8, 12], "poly_solv": 5, "poly_root": 5, "coeff": 5, "custom_init": 5, "bool": [0, 5], "fals": [0, 1, 5], "roots_init": 5, "pass": [1, 5, 6, 11], "true": [0, 1, 5, 6, 8, 9, 12], "feed": [1, 5], "custom": [0, 5, 9], "guess": [5, 6], "unspecifi": 5, "poly_roots_ea_multi": 5, "coeffs_matrix": 5, "initial_roots_matrix": 5, "1e": [5, 8], "12": 5, "max_it": 5, "absolut": [3, 5, 6], "updat": [5, 8, 9, 12], "poly_roots_ea": 5, "maximum": [1, 5, 7, 12], "_default_max_it": 5, "annual": [6, 12], "parallax": [6, 9, 12], "built": 9, "earth": 6, "project": [1, 6, 12], "correct": 3, "equatori": 6, "icr": [6, 9, 12], "frame": [0, 1, 6], "autodiff": 9, "lightweight": [], "fix": [6, 8, 11], "numer": [8, 11], "need": [6, 11, 12], "peri_vern": 6, "tref": 6, "perihelion": 6, "vernal": 6, "equinox": 6, "epoch": 6, "nearest": [6, 7], "getpsi": 6, "phi": 6, "ecc": 6, "kepler": 6, "eccentr": 6, "anomali": 6, "prepare_projection_basi": 6, "rotaxis_deg": 6, "psi_offset": 6, "ra": 6, "dec": 6, "build": [1, 6, 11], "orbit": [6, 9, 12], "rotat": 6, "sky": 6, "north": 6, "east": 6, "basi": [0, 6], "project_earth_posit": 6, "tperi": 6, "period": 6, "sun": 6, "onto": 6, "target": 6, "tangent": 6, "set_parallax": 6, "tvernal": 6, "quantiti": [3, 6], "local": 6, "veloc": 6, "around": 6, "compute_parallax": 6, "pien": 6, "piee": 6, "parallax_param": 6, "offset": 6, "add": [6, 12], "dimensionless": [1, 6], "tau": [6, 9, 12], "impact": [6, 9, 12], "u": 6, "jd": 6, "2450000": 6, "unless": [], "state": [], "otherwis": [0, 1, 7], "right": 6, "ascens": 6, "declin": 6, "degre": [1, 6], "orthonorm": 6, "orthogon": 6, "line": [6, 12], "sight": 6, "lo": [], "obliqu": 6, "23": 6, "44": 6, "deg": [], "0167": 6, "sider": 6, "year": 6, "365": 6, "25636": 6, "dai": [6, 9, 12], "hand": [], "z_eq": [], "pole": [], "increas": [1, 11, 12], "tm": [], "dtn": 6, "um": [], "u0": [9, 12], "dum": 6, "t0": [9, 12], "te": [9, 12], "exampl": [0, 6, 8, 9, 11, 12], "8000": [], "266": [], "4168": [], "29": [], "0078": [], "linspac": [8, 9, 12], "meeu": [], "astronom": [], "algorithm": 7, "2nd": 12, "ed": [], "willmann": [], "bell": [], "seidelmann": [], "p": 0, "k": 9, "explanatori": [], "supplement": [], "almanac": [], "gould": [], "2004": [], "resolut": [], "microlen": [], "degeneraci": [], "apj": [], "606": [], "319": [], "produc": [1, 6], "induc": 6, "should": [6, 12], "which": [0, 6, 7], "signal": 6, "amplitud": [3, 6], "direct": [6, 12], "match": [4, 6, 7, 8, 11], "motion": [6, 9, 12], "remov": 6, "isol": 6, "contribut": [3, 6], "sin": [6, 9, 12], "raphson": 6, "empir": 6, "work": [6, 8, 9, 11], "radian": [1, 6, 9, 12], "mai": [3, 6, 12], "85": 6, "well": 6, "moder": 6, "without": [6, 12], "count": 6, "keep": [1, 6, 11, 12], "control": [6, 12], "flow": [6, 9], "closest": [6, 7, 12], "pre": 6, "tabul": 6, "accept": [1, 4, 6], "both": [1, 4, 6, 11], "julian": 6, "date": 6, "larger": [1, 6, 12], "than": 6, "2_450_000": 6, "subtract": 6, "so": [0, 1, 6, 12], "compar": 6, "against": [6, 7], "tabl": 6, "below": [6, 8, 9, 12], "neighbor": 6, "interpol": 6, "found": 6, "rule": 6, "pair": 6, "2458000": 6, "eclipt": 6, "tilt": 6, "between": [0, 1, 6, 7, 12], "align": [6, 12], "celesti": 6, "its": 6, "ellipt": 6, "1d": 6, "stack": [1, 6, 8, 11], "q_north": 6, "q_east": 6, "toward": 6, "dt": 6, "includ": [6, 7], "differ": 6, "either": 6, "automat": [6, 12], "anchor": 6, "auto": [6, 9], "qne0": 6, "vne0": 6, "element": [1, 6, 7], "d": 6, "width": 6, "reduc": [6, 12], "truncat": 6, "preserv": [1, 6], "first_nonzero": 7, "first_zero": 7, "last_nonzero": 7, "match_point": 7, "indic": [1, 7], "permut": 7, "guarante": [], "elementwis": [], "assign": 7, "problem": [7, 11, 12], "array_lik": 0, "specifi": [1, 12], "max_zero_avoid": 7, "mean_zero_avoid": 7, "min_zero_avoid": 7, "minimum": 7, "sparse_argsort": 7, "collect": [], "contributor": 9, "power": [], "user": [11, 12], "who": [], "want": 12, "run": [8, 9, 12], "rebuild": [], "instal": [9, 11], "first": [0, 1, 7], "pip": [8, 11], "dev": 8, "cpu": [1, 8, 9, 11], "pytest": [], "specif": [], "opt": [], "On": 11, "cuda": [8, 9, 11], "capabl": [], "machin": [], "skip": 7, "cannot": 9, "see": [1, 8, 9], "devic": [8, 11, 12], "No": [], "environ": [9, 11], "variabl": 11, "though": 8, "jax_platform": 11, "help": 11, "you": [8, 11, 12], "runtim": 11, "sphinx": [], "live": [], "docs_src": [], "render": [], "html": [], "commit": [], "doc": [], "conveni": [], "cd": 8, "site": [], "appear": 12, "publish": 8, "github": [8, 11], "push": [], "file": [], "wire": [], "workflow": [9, 12], "ruff": [], "lint": [], "format": [], "befor": [0, 1, 11, 12], "chang": 12, "enabl": [0, 8, 9, 12], "64": [8, 12], "bit": [8, 12], "mode": [8, 12], "dure": 0, "reproduc": 11, "python": [8, 11, 12], "py": 8, "import": [8, 9, 12], "config": [8, 9, 12], "jax_enable_x64": [8, 9, 11, 12], "open": 11, "issu": [11, 12], "start": [1, 9, 12], "discuss": [], "encount": [], "propos": [], "section": 9, "set": [0, 1, 4, 7, 11, 12], "ensur": 11, "talk": [], "your": [8, 11, 12], "avail": 1, "hardwar": 12, "9": 8, "newer": 8, "jaxlib": [8, 11], "acceler": [1, 8, 9], "onli": [0, 1, 11, 12], "rocm": [8, 11], "numpi": [8, 9, 11, 12], "scipi": 7, "pypi": 8, "recommend": 8, "microjaxx": 8, "name": 8, "upgrad": 1, "latest": 8, "releas": 8, "develop": 12, "git": 8, "clone": 8, "http": 8, "shotamiyazaki94": [8, 9], "offici": [8, 11], "guid": 8, "wheel": 8, "verifi": 9, "detect": 8, "correctli": [], "print": [8, 11, 12], "__version__": [8, 11], "precis": 11, "continu": 12, "usag": [1, 8, 9, 11], "snippet": [8, 11, 12], "review": [], "plan": 8, "suit": [], "toolkit": 9, "top": 9, "contour": 0, "trajectori": [1, 9, 10], "readi": 9, "likelihood": [1, 9, 10, 12], "companion": 1, "readm": [], "walk": [8, 12], "common": [8, 9, 11], "while": [1, 7], "link": [], "detail": [3, 8], "public": [1, 8], "next": 9, "light": [1, 12], "tip": [], "code": 11, "style": [], "ask": [], "question": [], "rai": [9, 10, 11, 12], "lightcurv": [9, 10, 12], "solver": [0, 1, 9, 10, 11, 12], "highlight": [], "past": [], "notebook": 12, "script": [11, 12], "onc": [], "notat": [], "1j": [1, 8, 9, 12], "05": 12, "05j": 12, "centr": [1, 11], "shoot": [9, 11, 12], "fallback": [], "02": [9, 12], "alpha": [9, 12], "30": 9, "deg2rad": [9, 12], "800": [], "y1": [9, 12], "co": [9, 12], "y2": [9, 12], "dtype": [9, 12], "750": [], "400": [], "mani": [11, 12], "tune": [], "trade": 11, "execut": [], "speed": [], "abov": 12, "adjust": [11, 12], "memori": [1, 9, 12], "budget": 1, "contain": 4, "instanc": [], "expos": [], "straight": 12, "api": [1, 8, 12], "global": [], "care": [], "about": [], "To": 12, "just": [], "those": 4, "vmap": [1, 12], "vectoris": [], "dict": 4, "n_branch": 4, "collaps": 4, "store": 4, "combin": [1, 9, 12], "deliv": [1, 9], "accur": [1, 9], "cost": [1, 12], "manag": 1, "kei": 1, "export": 1, "estim": [0, 1], "everywher": [0, 9], "fail": 1, "heurist": [0, 1], "hybrid": 1, "trigger": [0, 1], "decid": 1, "chunk": 1, "expens": [], "call": [1, 12], "balanc": 1, "occup": 1, "limb": [0, 1, 3, 9, 12], "darken": [0, 1, 3, 9], "awar": [1, 9], "switch": [], "seamlessli": [], "uniform": [1, 3], "profil": 1, "toggl": [], "share": [1, 7], "infrastructur": 1, "knob": 12, "behav": [], "downstream": 1, "miyazaki": [1, 9], "kawahara": [1, 9], "prep": 1, "descript": 1, "forthcom": 1, "argument": [0, 12], "mirror": 12, "lower": 11, "level": [1, 8], "extended_sourc": [0, 1], "along": [1, 7, 12], "trail": [], "angular": [1, 12], "einstein": [0, 1, 3, 9, 12], "radial": [1, 12], "quadratur": 0, "panel": [], "azimuth": 0, "contract": [], "factor": [], "ring": [], "bin": 1, "polar": 1, "mesh": [], "structur": [], "radii": [1, 12], "domain": [], "size": 1, "fed": [], "keyword": [0, 1, 12], "guard": [], "veri": [9, 11], "fire": [], "recomput": 1, "mag_uniform": 1, "mag_limb_dark": 1, "lazili": 1, "block_until_readi": 1, "synchronis": 1, "asynchron": [], "context": 12, "logic": [], "current": [0, 12], "yet": [0, 1], "been": 12, "specialis": 1, "receiv": [], "must": 12, "suppli": [1, 12], "alwai": 0, "patch": [], "cusp": [], "reson": [], "higher": 9, "reach": [], "converg": [], "sketch": [], "layout": [], "orient": [], "yourself": [], "interfac": 1, "hous": [], "machineri": [], "driver": 11, "offer": [], "marginalis": [9, 12], "drop": 12, "numpyro": [], "black": [], "box": [], "optimis": [], "etc": [], "compos": [9, 12], "photometr": [], "heavi": [], "kernel": [], "workload": [], "benefit": [], "larg": [], "stai": [], "resid": [], "establish": [], "baselin": [1, 12], "re": [], "previous": [], "warm": [], "graph": [], "compact": [], "dimension": [1, 7], "throughout": [], "semant": [], "lead": [1, 12], "ax": [9, 12], "concret": [], "brows": [], "callabl": [], "signatur": [], "regener": [], "group": [], "platform": [8, 11], "visibl": [], "forc": 11, "determinist": 7, "xla_flag": [], "xla_gpu_deterministic_op": [], "artifact": [], "autom": [], "deploy": [], "consid": 1, "ci": [], "explicit": [], "tidi": [], "static": [], "hint": [], "gradual": 11, "being": [], "pyright": [], "product": 12, "wrap": 12, "trace_funct": [], "start_trac": [], "trace": [1, 11], "viewabl": [], "tensorboard": [], "experi": [], "benchmark": [], "repres": [], "interact": [], "strongli": [], "thread": [], "pleas": [], "inform": 11, "saniti": [], "11": [], "compil": [11, 12], "matplotlib": [8, 9, 11], "seaborn": [8, 11], "plot": [8, 9, 11], "recent": [], "stabl": [], "even": 8, "pick": 7, "cleanli": 8, "smoke": 8, "concept": [], "architectur": [], "explain": 12, "how": [11, 12], "togeth": 11, "troubleshoot": [8, 9], "list": 8, "pitfal": 8, "quick": 8, "hmc": 9, "vi": 9, "512": [], "pi": [], "4": 12, "toi": [], "mag": [1, 12], "001": [], "explor": 9, "dig": 9, "prerequisit": 9, "practic": 9, "my": 9, "stall": 9, "still": 9, "stuck": 9, "strategi": [], "data": [], "further": 12, "read": [], "tool": [], "most": [11, 12], "report": 11, "new": 11, "summaris": 11, "suggest": 11, "doubl": 11, "xla_python_client_prealloc": 11, "temporarili": 11, "multi": 11, "confirm": [8, 11], "access": 11, "nvidia": 11, "smi": 11, "equival": [7, 11], "scale": [], "more": 9, "process": [1, 12], "launch": [], "decreas": [], "turn": 11, "sensit": 11, "take": [0, 11], "shorten": 11, "length": 11, "repeat": 11, "recompil": 11, "pull": 11, "extra": 0, "manual": [11, 12], "intend": 12, "demo": 11, "happi": 11, "debug": 11, "document": 11, "chapter": 12, "relev": [], "95": 12, "5e": 12, "40": 12, "60": 12, "1024": 12, "768": [], "128": [], "limit": [1, 12], "shrink": [], "challeng": [], "6": [], "210": 12, "functool": 12, "partial": 12, "grad": [], "def": 12, "loglik": [], "model_flux": [], "data_flux": [], "loglike_jit": [], "dloglike_dq": [], "block": 12, "miss": 7, "peak": [], "interv": [], "utilis": [], "cach": [], "instead": 12, "xla": 9, "acceral": 9, "icir": [], "n_point": 9, "mag_p": 9, "mag_ext": 9, "crit": 9, "cau": 9, "also": [9, 11, 12], "copyright": 9, "2025": 9, "shota": 9, "maintain": 9, "hajim": 9, "hajimekawahara": 9, "other": [3, 9, 12], "effect": [1, 9], "prepar": 8, "visual": 8, "Or": 8, "better": 8, "alreadi": 12, "one": [0, 1, 12], "grid": [11, 12], "constrain": [], "spend": [], "bodi": 12, "As": [], "rais": [11, 12], "setup": 9, "what": 12, "doe": [7, 12], "goal": 12, "copi": 12, "pasteabl": 12, "own": 12, "session": 12, "everyth": 12, "place": [0, 12], "easier": 12, "stabilis": 12, "cell": [1, 12], "ha": 12, "restart": 12, "rerun": 12, "infinitesim": 12, "assembl": 12, "associ": 12, "00": 12, "10j": 12, "02j": 12, "introduc": 12, "sweep": 12, "typic": [0, 3], "rang": [], "secondari": [], "primari": [], "chosen": [], "littl": [], "longer": [], "becaus": [0, 1], "rectilinear": 12, "feel": 12, "free": 12, "sampler": 12, "approach": 12, "stick": 12, "hit": 12, "multipli": 12, "intrins": 12, "lookup": [], "256": [], "dictat": [], "long": [], "end": [], "cap": 11, "oscil": [], "allow": [], "tandem": [], "calcul": 12, "describ": 12, "explicitli": 12, "mags_tripl": 12, "guidelin": 12, "often": 12, "intric": [], "possibli": [], "excess": [], "pressur": 11, "measur": [1, 12], "counter": [1, 12], "clockwis": [1, 12], "jacrev": [], "load": [], "example_lightcurv": [], "npy": [], "forward_model": 12, "instrument": 12, "forward_jit": 12, "neg_log_lik": [], "especi": [], "simultan": [], "uncertainti": [], "beyond": [1, 7, 12], "piec": 12, "keplerian": [], "progress": [], "docstr": [], "statu": [], "resampl": [], "These": 12, "compon": 12, "significantli": 12, "dimens": [], "reli": [], "whenev": [], "erod": [], "nuisanc": 12, "autocorrel": 12, "divis": 12, "accord": 12, "It": [0, 7, 12], "upper": 12, "parallel": 12, "exce": 12, "caus": 12, "smaller": [1, 11, 12], "safer": 12, "capac": 12, "annular": 12, "sector": 12, "In": 12, "do": [11, 12], "catastroph": 12, "mag_hexadecapol": [0, 1, 3], "z_mask": 3, "locat": 3, "n_imag": 3, "boolean": [1, 3], "mask": [1, 3], "obtain": [1, 3], "quadrupol": 3, "residu": 3, "diagnost": 3, "gaug": 3, "insuffici": 3, "cassan": 3, "et": 3, "al": 3, "2017": 3, "moment": 3, "w_k": 3, "gamma": 3, "sign": 6, "last": 7, "greedi": 7, "neighbour": 7, "unus": 7, "suffici": [0, 1, 7], "One": [1, 7], "candid": 7, "argsort": [1, 7], "sort": 7, "nan": 7, "trapz_zero_avoid": 7, "tail_idx": 7, "trapezoid": 7, "omit": 7, "final": 7, "segment": 7, "reliabl": [0, 7], "trim": 11, "cut": 11, "demand": 11, "crash": 11, "underutilis": 11, "bound": 11, "off": 11, "revert": 11, "recentr": 1, "ii": [], "mu_multi": [], "iii": [], "cond_extend": 1, "_caustics_proximity_test": [], "_planetary_caustic_test": [], "trust": [], "preced": [], "ones": [], "splice": [], "uniformli": [0, 1], "space": 1, "surfac": 1, "bright": 1, "smooth": 1, "boundari": 1, "calc_facb": 1, "seed": 1, "region": 1, "histogram": 1, "cluster": 1, "subregion": 1, "finer": [], "convert": 1, "disabl": 1, "host": 1, "mandatori": 1, "understood": [0, 1], "low": 1, "unchang": [0, 1], "answer": [], "consum": [], "unshift": 1, "immedi": [], "refin": [0, 1], "impli": 1, "dedic": [], "consequ": 1, "canon": [], "retain": 1, "untouch": 1, "degener": [], "min": 1, "treatment": [], "invoc": 1, "coupl": 1, "interpret": 1, "mark": 1, "reorder": 1, "front": 1, "resolv": 1, "featur": 1, "stage": 1, "enforc": 1, "procedur": 1, "analog": 1, "leav": 1, "expand": 1, "subset": 1, "1st": 12, "m3": [0, 12], "masss": 12, "3rd": 12, "jacfwd": 12, "due": 12, "pyplot": 9, "plt": 9, "fig": 9, "subplot": 9, "figsiz": 9, "label": 9, "set_xlabel": 9, "set_ylabel": 9, "set_yscal": 9, "legend": 9, "show": 9, "npts_limb": 0, "limb_darken": 0, "npts_ld": 0, "star": [], "mag_extended_sourc": 0, "whether": [], "enough": [], "sq": [], "r_3e": [], "ipsi": [], "flag": [], "taken": [], "account": [], "magnitud": 0, "warn": [], "At": [], "substanti": [], "fbartol": [], "19": [], "distribut": [], "greater": [], "geometr": [], "until": [], "stellar": [], "z_1": [], "prime": [], "z_2": [], "dz_1": [], "dz_2": [], "dominik": 0, "1998": 0, "m_2": [], "m_1": [], "m_3": [], "phase": [], "roots_itmax": [], "roots_compens": [], "compens": [], "afterward": 0, "exact": 0, "ghost": 0, "linearli": 0, "rtype": 0, "incur": 0, "slowdown": 0, "slower": 0}, "objects": {"microjax.caustics": [[0, 0, 0, "-", "lightcurve"]], "microjax.caustics.lightcurve": [[0, 1, 1, "", "magnifications"]], "microjax.inverse_ray": [[1, 0, 0, "-", "lightcurve"]], "microjax.inverse_ray.lightcurve": [[1, 1, 1, "", "mag_binary"], [1, 1, 1, "", "mag_triple"]], "microjax": [[2, 0, 0, "-", "likelihood"], [3, 0, 0, "-", "multipole"], [4, 0, 0, "-", "point_source"], [5, 0, 0, "-", "poly_solver"], [6, 0, 0, "-", "trajectory"], [7, 0, 0, "-", "utils"]], "microjax.likelihood": [[2, 1, 1, "", "linear_chi2"], [2, 1, 1, "", "nll_ulens"], [2, 1, 1, "", "nll_ulens_general"]], "microjax.multipole": [[3, 1, 1, "", "mag_hexadecapole"]], "microjax.point_source": [[4, 1, 1, "", "critical_and_caustic_curves"], [4, 1, 1, "", "lens_eq"], [4, 1, 1, "", "lens_eq_det_jac"], [4, 1, 1, "", "mag_point_source"]], "microjax.poly_solver": [[5, 1, 1, "", "poly_roots"], [5, 1, 1, "", "poly_roots_EA_multi"]], "microjax.trajectory": [[6, 1, 1, "", "compute_parallax"], [6, 1, 1, "", "getpsi"], [6, 1, 1, "", "peri_vernal"], [6, 1, 1, "", "prepare_projection_basis"], [6, 1, 1, "", "project_earth_position"], [6, 1, 1, "", "set_parallax"]], "microjax.utils": [[7, 1, 1, "", "first_nonzero"], [7, 1, 1, "", "first_zero"], [7, 1, 1, "", "last_nonzero"], [7, 1, 1, "", "match_points"], [7, 1, 1, "", "max_zero_avoiding"], [7, 1, 1, "", "mean_zero_avoiding"], [7, 1, 1, "", "min_zero_avoiding"], [7, 1, 1, "", "sparse_argsort"], [7, 1, 1, "", "trapz_zero_avoiding"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "microjax": 9, "": [], "document": [], "indic": 9, "tabl": 9, "test": [], "packag": [], "subpackag": [], "submodul": [], "conftest": [], "modul": [], "content": [], "util": [2, 7], "gpu": 11, "invers": 1, "rai": 1, "lightcurv": [0, 1], "likelihood": 2, "multipol": 3, "point": [4, 12], "sourc": [4, 12], "polynomi": 5, "solver": 5, "design": [1, 5], "highlight": [1, 5, 9], "note": 5, "numer": 5, "behavior": 5, "trajectori": [6, 12], "function": [4, 7], "convent": 4, "sign": [], "develop": [], "suit": [], "code": [], "style": [], "where": [], "ask": [], "question": [], "get": 8, "start": 8, "requir": [], "instal": 8, "first": [], "check": [], "next": 8, "step": 12, "guid": [9, 12], "api": [9, 10], "refer": [9, 10], "usag": 12, "magnif": 12, "extend": [], "light": [], "curv": [], "helper": 12, "tip": [], "coordin": 4, "workflow": 1, "outlin": 1, "concept": [], "architectur": [], "core": [], "execut": [], "model": [], "accuraci": [], "strategi": [], "kei": [], "data": [], "further": [], "read": [], "tool": [], "profil": [], "support": [], "prerequisit": 8, "verifi": 8, "environ": 8, "up": 8, "quick": 9, "peek": 9, "intern": [], "contribut": [], "troubleshoot": 11, "jax": 11, "cannot": 11, "see": 11, "my": 11, "mag_binari": 11, "i": 11, "slow": 11, "run": 11, "out": 11, "memori": 11, "gradient": 11, "comput": 11, "stall": 11, "import": 11, "error": 11, "option": 11, "depend": 11, "still": 11, "stuck": 11, "finit": 12, "binari": 12, "lens": 12, "tripl": 12, "autodiff": 12, "jit": 12, "best": 12, "practic": 12, "licens": 9, "attribut": 9, "common": 12, "setup": 12, "mag_point_sourc": [], "paramet": 12, "1": 12, "build": 12, "2": 12, "evalu": 12, "fine": 12, "tune": 12, "caustic": 0, "behaviour": 0, "summari": 0}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Likelihood Utilities": [[2, "module-microjax.likelihood"]], "Multipole": [[3, "module-microjax.multipole"]], "Point Source": [[4, "module-microjax.point_source"]], "Functions": [[4, "functions"]], "Coordinate conventions": [[4, "coordinate-conventions"]], "Design highlights": [[5, "design-highlights"], [1, "design-highlights"]], "Polynomial Solver": [[5, "module-microjax.poly_solver"]], "Notes on numerical behavior": [[5, "notes-on-numerical-behavior"]], "Trajectories": [[6, "module-microjax.trajectory"]], "Utility Functions": [[7, "module-microjax.utils"]], "Getting Started": [[8, "getting-started"]], "Prerequisites": [[8, "prerequisites"]], "Installation": [[8, "installation"]], "Verify the environment": [[8, "verify-the-environment"]], "Up next": [[8, "up-next"]], "Troubleshooting": [[11, "troubleshooting"]], "JAX cannot see my GPU": [[11, "jax-cannot-see-my-gpu"]], "mag_binary is slow or runs out of memory": [[11, "mag-binary-is-slow-or-runs-out-of-memory"]], "Gradient computations stall": [[11, "gradient-computations-stall"]], "Import errors for optional dependencies": [[11, "import-errors-for-optional-dependencies"]], "Still stuck?": [[11, "still-stuck"]], "microJAX": [[9, "microjax"]], "Highlights": [[9, "highlights"]], "Quick peek": [[9, "quick-peek"]], "Guides": [[9, null]], "API Reference": [[9, null], [10, "api-reference"]], "Indices and tables": [[9, "indices-and-tables"]], "References": [[9, "references"]], "License & Attribution": [[9, "license-attribution"]], "Inverse-Ray Lightcurve": [[1, "module-microjax.inverse_ray.lightcurve"]], "Workflow outline": [[1, "workflow-outline"]], "Usage Guide": [[12, "usage-guide"]], "Common setup": [[12, "common-setup"]], "Point-source magnification": [[12, "point-source-magnification"]], "Step-by-step": [[12, "step-by-step"]], "Finite-source binary lenses": [[12, "finite-source-binary-lenses"]], "1. Build the trajectory": [[12, "build-the-trajectory"]], "2. Evaluate the magnification": [[12, "evaluate-the-magnification"]], "Fine-tuning parameters": [[12, "fine-tuning-parameters"]], "Triple lenses": [[12, "triple-lenses"]], "Autodiff and jit": [[12, "autodiff-and-jit"]], "Trajectory helpers": [[12, "trajectory-helpers"]], "Best practices": [[12, "best-practices"]], "Caustics Lightcurve": [[0, "module-microjax.caustics.lightcurve"]], "Behaviour summary": [[0, "behaviour-summary"]]}, "indexentries": {"magnifications() (in module microjax.caustics.lightcurve)": [[0, "microjax.caustics.lightcurve.magnifications"]], "microjax.caustics.lightcurve": [[0, "module-microjax.caustics.lightcurve"]], "module": [[0, "module-microjax.caustics.lightcurve"]]}})