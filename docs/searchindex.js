Search.setIndex({"docnames": ["api/inverse_ray_lightcurve", "api/likelihood", "api/multipole", "api/point_source", "api/poly_solver", "api/trajectory", "api/utils", "concepts", "development", "getting_started", "index", "modules", "troubleshooting", "usage"], "filenames": ["api/inverse_ray_lightcurve.rst", "api/likelihood.rst", "api/multipole.rst", "api/point_source.rst", "api/poly_solver.rst", "api/trajectory.rst", "api/utils.rst", "concepts.rst", "development.rst", "getting_started.rst", "index.rst", "modules.rst", "troubleshooting.rst", "usage.rst"], "titles": ["Inverse-Ray Lightcurve", "Likelihood Utilities", "Multipole", "Point Source", "Polynomial Solver", "Trajectories", "Utility Functions", "Concepts &amp; Architecture", "Development", "Getting Started", "Welcome to microJAX\u2019s documentation!", "API Reference", "Troubleshooting", "Usage Guide"], "terms": {"index": [6, 10], "modul": [0, 1, 3, 4, 5, 8, 9, 10, 13], "search": [5, 10], "page": [7, 8, 10], "test": [0, 7, 9, 10], "packag": [10, 12], "subpackag": [], "util": [0, 3, 4, 5, 9, 10, 11], "submodul": [], "gpu": [0, 7, 8, 9, 10, 13], "content": [], "conftest": [], "adapt": [0, 7, 10, 12, 13], "comput": [0, 1, 3, 5, 10], "mix": 0, "multipol": [0, 7, 10, 11], "method": [0, 4, 5], "thi": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13], "microlens": [1, 3, 5, 10], "default": [1, 3, 4, 5, 8], "fast": [0, 1, 7, 10], "hexadecapol": [0, 7, 13], "approxim": [0, 5, 7, 10, 13], "select": [0, 5], "invok": [], "full": [0, 1, 7, 8, 13], "finit": [0, 5, 7, 10], "sourc": [0, 1, 7, 8, 9, 10, 11], "integr": [0, 1, 7, 10, 13], "caustic": [0, 3, 7, 13], "when": [0, 1, 3, 4, 7, 8], "requir": [0, 3, 7, 12], "accuraci": [0, 10, 12], "microjax": [0, 1, 3, 4, 5, 6, 7, 9, 12, 13], "inverse_rai": [0, 7, 10, 13], "mag_binari": [0, 7, 10, 13], "w_point": 0, "arrai": [0, 1, 3, 4, 5, 6, 7, 13], "rho": [0, 10, 13], "float": [0, 1, 4, 5], "r_resolut": [0, 12, 13], "int": [0, 3, 4], "1000": 0, "th_resolut": [0, 12, 13], "u1": 0, "0": [0, 1, 5, 6, 9, 10, 13], "delta_c": 0, "01": [0, 10, 13], "nlimb": [0, 12, 13], "500": 0, "bins_r": 0, "50": [0, 5], "bins_th": 0, "120": 0, "margin_r": 0, "1": [0, 1, 3, 4, 5, 9, 10, 13], "margin_th": 0, "max_full_cal": [0, 8, 12, 13], "chunk_siz": [0, 8, 12, 13], "100": [0, 4, 5], "param": [0, 3, 5], "binari": [0, 3, 9, 10], "len": [0, 3, 7, 9, 10, 13], "solv": [0, 3, 5, 7], "paramet": [0, 1, 3, 4, 5, 6, 13], "follow": [7, 8, 9, 12], "underli": [], "The": [0, 1, 4, 5, 8, 9, 10, 12, 13], "us": [0, 3, 4, 5, 7, 8, 9, 10, 12, 13], "proxim": [0, 7], "plu": [], "planetari": [0, 7], "check": [8, 9, 12], "small": [0, 1, 4, 5], "mass": [0, 3], "ratio": [0, 3], "return": [0, 1, 3, 4, 5, 6, 13], "magnif": [0, 3, 7, 9, 10], "per": [1, 4, 12], "input": [1, 3, 5], "time": [5, 7], "posit": [1, 3, 5, 7], "mag_tripl": [0, 13], "tripl": [0, 3, 9, 10], "simpl": 1, "linear": [0, 1, 5, 6], "fit": [1, 9, 13], "photometri": 1, "provid": [1, 3, 4, 5, 7, 13], "jax": [0, 1, 3, 4, 5, 7, 8, 9, 10, 13], "friendli": [1, 3, 4, 5], "weight": 1, "least": 1, "squar": 1, "neg": 1, "log": 1, "nll": 1, "under": [1, 5, 8], "gaussian": 1, "model": [1, 10, 13], "two": [1, 7], "variant": 1, "ar": [0, 1, 3, 4, 5, 7, 8, 12], "implement": [1, 3, 4, 7], "nll_ulen": 1, "path": [1, 7, 8], "diagon": 1, "observ": [1, 5], "nois": 1, "prior": 1, "blend": 1, "flux": [1, 7, 13], "nll_ulens_gener": 1, "rank": 1, "covari": 1, "arbitrari": 1, "mean": [1, 5], "all": [0, 1, 3, 4, 7, 13], "routin": [0, 1, 3, 5, 7, 13], "oper": [1, 3], "jnp": [1, 4, 5, 9, 10, 13], "ndarrai": 1, "differenti": [1, 4, 5, 10, 12, 13], "make": [1, 4, 8], "them": [1, 13], "suitabl": 1, "gradient": [1, 3, 4, 10, 13], "base": [1, 4, 5, 13], "optim": 1, "infer": [1, 5, 7, 10, 13], "linear_chi2": 1, "x": [0, 1, 3, 5, 6, 7], "y": [0, 1, 3, 7], "err": 1, "union": [1, 5], "tupl": [1, 3, 5], "b": [1, 6, 8], "chi": 1, "perform": [1, 3], "close": 1, "form": [1, 3], "independ": 1, "error": [1, 5, 7, 10], "If": [1, 5, 8, 13], "ani": [0, 1], "entri": [1, 5], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 13], "point": [1, 5, 7, 9, 10, 11, 12], "treat": 1, "unweight": 1, "shape": [0, 1, 3, 4, 5], "n": [1, 4, 5], "predictor": 1, "valu": [0, 1, 3, 4, 5], "respons": 1, "option": [0, 1, 3, 4, 5, 9, 10], "standard": 1, "deviat": 1, "A": [1, 5, 9, 12], "scalar": [1, 3, 5], "broadcast": [1, 5, 7, 13], "zero": [1, 4], "replac": [0, 1], "best": [1, 10], "slope": 1, "intercept": 1, "ae": 1, "chi2": 1, "evalu": [0, 1, 3, 5, 7], "note": [0, 1, 3, 5, 8], "solut": 1, "minim": [1, 6, 8, 12], "sum_i": 1, "w_i": 1, "y_i": 1, "x_i": 1, "2": [1, 3, 5, 9, 10, 13], "err_i": 1, "els": 1, "m": [1, 8, 9], "sigma2_ob": 1, "sigma2_f": 1, "sigma2_fb": 1, "assum": 1, "f": [1, 3], "fb": 1, "c": [1, 12], "diag": 1, "varianc": 1, "over": [1, 3, 5, 6, 13], "done": 1, "analyt": [1, 7, 10], "yield": 1, "margin": [0, 1], "design": [1, 7], "matrix": [1, 5, 9, 12], "column": 1, "m_f": 1, "where": [1, 3, 5], "term": 1, "constant": [1, 5], "captur": 1, "type": [0, 1, 3, 4, 5, 6, 8], "express": 1, "equal": 1, "5": [1, 5, 9, 13], "mahalanobi": 1, "lambda": 1, "t": [1, 5, 10, 13], "mu": [1, 9, 13], "gener": [1, 3, 7, 8], "non": 1, "an": [0, 1, 5, 8, 12], "result": [0, 1, 5, 7], "after": 1, "out": [1, 10], "map": [1, 3, 5], "symmetr": [1, 5], "definit": 1, "defin": [1, 5], "posterior": 1, "core": [3, 10], "gravit": 3, "up": [3, 7, 10, 12], "three": [3, 7], "lens": [0, 3, 7, 10], "lens_eq": 3, "complex": [0, 3, 4, 6, 7, 10, 13], "equat": [3, 5, 7], "imag": [3, 7, 10], "plane": [0, 3, 5, 10], "coordin": [0, 5, 7, 13], "z": 3, "w": [3, 7, 9, 10, 13], "lens_eq_det_jac": 3, "determin": 3, "jacobian": [3, 7], "through": [3, 9, 10, 12], "det": 3, "j": [3, 5], "critical_and_caustic_curv": 3, "critic": 3, "curv": [0, 3, 7, 13], "_images_point_sourc": 3, "given": [3, 4], "": [0, 3, 5, 9, 13], "correspond": [0, 3], "polynomi": [3, 7, 10, 11, 12], "_images_point_source_sequenti": 3, "helper": [3, 5, 7, 10], "track": 3, "across": [3, 13], "sequenc": 3, "reus": [0, 3, 13], "previou": 3, "root": [3, 4, 7], "initi": [3, 4, 5], "mag_point_sourc": [3, 7, 9, 13], "total": 3, "sum": [3, 6, 13], "function": 11, "written": [], "compat": [3, 7], "jit": [3, 5, 7, 10, 12], "vector": [4, 5], "batch": [0, 3, 4, 7, 10, 13], "appropri": 3, "number": [0, 3, 4, 5, 6, 7, 13], "encod": [3, 7], "2d": 3, "convent": 10, "configur": [0, 3, 13], "mid": 3, "system": [3, 10, 12], "coeffici": [0, 3, 4], "construct": [3, 4, 5, 7], "shift": [3, 5], "center": [3, 5], "handl": [3, 13], "invers": [3, 7, 10, 11, 13], "intern": [3, 5, 7], "necessari": [], "refer": [0, 3, 5, 7], "bartol": 3, "mit": 3, "licens": 3, "origin": 3, "inspir": 3, "some": [3, 12], "modifi": [3, 8], "here": [0, 3, 12], "extend": [3, 7], "support": [3, 4, 10, 13], "point_sourc": [3, 7, 9, 13], "npt": 3, "200": [3, 13], "nlens": [3, 9, 13], "sampl": [0, 3, 5, 7, 12, 13], "unit": [0, 3, 5], "circl": 3, "3": [3, 5, 9, 13], "addit": [0, 3, 13], "separ": [0, 3, 9], "q": [0, 3, 5, 8, 9, 10, 13], "m2": 3, "m1": 3, "we": [3, 12], "e1": 3, "q3": [0, 3, 13], "third": 3, "r3": [0, 3, 13], "radiu": [0, 3], "psi": [0, 3, 5, 13], "angl": [3, 5], "e2": 3, "z_cr": 3, "nbranch": [], "branch": [3, 5], "order": [4, 6], "contigu": 7, "z_ca": 3, "via": [4, 5, 8], "For": [3, 4, 8], "singl": [5, 12], "output": [0, 3, 4, 5, 8, 13], "from": [0, 3, 4, 5, 7, 8, 9, 10, 13], "consist": [0, 3], "rest": 3, "librari": [3, 7, 8, 10], "like": 5, "depend": [0, 3, 8, 10], "half": 3, "fraction": 3, "second": [], "have": [0, 3, 12], "real": [3, 4], "axi": [5, 6], "distanc": 6, "r": 5, "respect": [], "exp": 10, "same": [0, 3, 5], "give": [], "arithmet": 3, "propag": 3, "expect": 3, "each": [3, 5], "none": 4, "com": 9, "appli": [3, 5], "builder": [], "valid": 3, "finder": [4, 7], "ehrlich": 4, "aberth": 4, "version": [4, 8, 9, 12], "ea": 4, "iter": [4, 5, 6], "find": [4, 6], "polyv": 4, "lax": 4, "while_loop": 4, "earli": 4, "stop": 4, "toler": 4, "implicit": [4, 12], "custom_jvp": 4, "revers": [4, 13], "forward": [0, 4, 12, 13], "ad": [0, 4, 5, 8, 13], "robust": 4, "regardless": 4, "deriv": [4, 5], "precomput": [4, 5], "avoid": [4, 6, 12, 13], "everi": [4, 6], "step": [4, 5], "relianc": 4, "polyd": 4, "nearli": 4, "tini": 4, "imaginari": 4, "part": 4, "threshold": 4, "10": [4, 9], "tol": 4, "pure": [4, 5], "present": [4, 13], "remain": [4, 8], "fulli": [4, 13], "ill": 4, "condit": 4, "case": 4, "e": [4, 5, 8, 9], "g": 4, "multipl": 4, "can": [4, 5, 7, 9, 13], "slow": [4, 10], "down": 4, "fall": 4, "back": 4, "newton": [4, 5], "denomin": 4, "get": [4, 10], "too": [4, 12], "improv": [4, 9, 12], "stabil": [4, 7, 9], "poly_solv": 4, "poly_root": 4, "coeff": 4, "custom_init": 4, "bool": 4, "fals": 4, "roots_init": 4, "pass": [4, 5, 7, 12, 13], "true": [4, 5, 7, 8, 9, 10, 13], "feed": [0, 4], "custom": [4, 7, 10, 13], "guess": [4, 5], "unspecifi": 4, "poly_roots_ea_multi": 4, "coeffs_matrix": 4, "initial_roots_matrix": 4, "1e": [4, 9], "12": 4, "max_it": 4, "absolut": [4, 5], "updat": [4, 8, 9, 10, 13], "poly_roots_ea": 4, "maximum": [0, 4, 6], "_default_max_it": 4, "annual": [5, 7, 13], "parallax": [5, 7, 10, 13], "built": [5, 10], "earth": 5, "project": [5, 7], "correct": 5, "equatori": 5, "icr": 5, "frame": 5, "autodiff": [5, 10], "lightweight": 5, "fix": [5, 8, 9, 12, 13], "numer": [5, 7, 9, 12], "need": [0, 5], "peri_vern": 5, "tref": 5, "perihelion": 5, "vernal": 5, "equinox": 5, "epoch": 5, "nearest": 5, "getpsi": 5, "phi": 5, "ecc": 5, "kepler": 5, "eccentr": 5, "anomali": 5, "prepare_projection_basi": 5, "rotaxis_deg": 5, "psi_offset": 5, "ra": 5, "dec": 5, "build": [0, 5, 7, 8, 12, 13], "orbit": 5, "rotat": 5, "sky": 5, "north": 5, "east": 5, "basi": 5, "project_earth_posit": 5, "tperi": 5, "period": 5, "sun": 5, "onto": 5, "target": [5, 9], "tangent": 5, "set_parallax": 5, "tvernal": 5, "quantiti": 5, "local": 5, "veloc": 5, "around": 5, "compute_parallax": 5, "pien": 5, "piee": 5, "parallax_param": 5, "offset": 5, "add": 5, "dimensionless": 5, "tau": [5, 13], "impact": 5, "u": 5, "jd": 5, "2450000": 5, "unless": 5, "state": 5, "otherwis": 5, "right": 5, "ascens": 5, "declin": 5, "degre": 5, "orthonorm": 5, "orthogon": 5, "line": 5, "sight": 5, "lo": 5, "obliqu": 5, "23": 5, "44": 5, "deg": 5, "0167": 5, "sider": 5, "year": 5, "365": 5, "25636": 5, "dai": 5, "hand": 5, "z_eq": 5, "pole": 5, "increas": [5, 12, 13], "tm": 5, "dtn": 5, "um": 5, "u0": [5, 13], "dum": 5, "t0": [5, 13], "te": [5, 13], "exampl": [5, 9, 10, 12, 13], "8000": 5, "266": 5, "4168": 5, "29": 5, "0078": 5, "linspac": [5, 9, 10, 13], "meeu": 5, "astronom": 5, "algorithm": [5, 6], "2nd": 5, "ed": 5, "willmann": 5, "bell": 5, "seidelmann": 5, "p": 5, "k": 5, "explanatori": 5, "supplement": 5, "almanac": 5, "gould": 5, "2004": 5, "resolut": [5, 13], "microlen": 5, "degeneraci": 5, "apj": 5, "606": 5, "319": 5, "produc": 5, "induc": 5, "should": 5, "which": [5, 6], "signal": 5, "amplitud": 5, "direct": 5, "match": [3, 5, 9, 12], "motion": [5, 10], "remov": 5, "isol": 5, "contribut": 5, "sin": [5, 13], "raphson": 5, "empir": 5, "work": [5, 10], "radian": [0, 5], "mai": [0, 5], "85": 5, "well": 5, "moder": 5, "without": 5, "count": [0, 5], "keep": [0, 5, 7, 8, 13], "control": [5, 13], "flow": [5, 10], "closest": [5, 6], "pre": 5, "tabul": 5, "accept": [3, 5], "both": [3, 5, 7, 8], "julian": 5, "date": 5, "larger": [5, 7], "than": 5, "2_450_000": 5, "subtract": 5, "so": [0, 5, 7, 12, 13], "compar": 5, "against": 5, "tabl": [0, 5, 12], "below": [5, 10], "neighbor": 5, "interpol": [0, 5], "found": 5, "rule": 5, "pair": 5, "2458000": 5, "eclipt": 5, "tilt": 5, "between": [0, 5, 6, 7, 13], "align": 5, "celesti": 5, "its": 5, "ellipt": 5, "1d": [5, 6], "stack": [0, 5], "q_north": 5, "q_east": 5, "toward": 5, "dt": 5, "includ": [5, 7, 8], "differ": 5, "either": 5, "automat": 5, "anchor": 5, "auto": [5, 7, 10], "qne0": 5, "vne0": 5, "element": [5, 6], "d": 5, "width": 5, "reduc": [5, 12, 13], "truncat": 5, "preserv": [0, 5], "first_nonzero": 6, "first_zero": 6, "last_nonzero": 6, "match_point": 6, "indic": 6, "permut": 6, "guarante": 6, "elementwis": 6, "assign": 6, "problem": [6, 12], "array_lik": 6, "specifi": 6, "max_zero_avoid": 6, "mean_zero_avoid": 6, "min_zero_avoid": 6, "minimum": 6, "sparse_argsort": 6, "collect": 8, "contributor": 8, "power": 8, "user": [8, 12], "who": 8, "want": 8, "run": [8, 9, 10, 13], "rebuild": 8, "instal": [8, 10, 12], "first": [0, 8], "pip": [8, 9, 12], "dev": [8, 9], "cpu": [0, 8, 9, 12], "pytest": 8, "specif": 8, "opt": 8, "On": [12, 13], "cuda": [8, 9, 10, 12], "capabl": [], "machin": [], "skip": 8, "cannot": 10, "see": [0, 7, 9, 10], "devic": [7, 9, 12, 13], "No": [], "environ": [10, 12], "variabl": 12, "though": 9, "jax_platform": [8, 12], "help": 12, "you": [0, 7, 8, 12, 13], "runtim": 12, "sphinx": 8, "live": 7, "docs_src": 8, "render": [], "html": 8, "commit": [], "doc": 8, "conveni": [], "cd": [8, 9], "site": 8, "appear": 8, "publish": 9, "github": [8, 9, 12], "push": [], "file": 8, "wire": 7, "workflow": [10, 13], "ruff": 8, "lint": [], "format": 8, "befor": [7, 12], "chang": [], "enabl": [8, 9, 13], "64": [7, 8, 9, 13], "bit": [7, 8, 9, 13], "mode": [7, 8, 9, 13], "dure": 0, "reproduc": [8, 12], "python": [8, 9, 12], "py": [8, 9], "import": [8, 9, 10, 13], "config": [8, 9, 10, 13], "jax_enable_x64": [7, 8, 9, 10, 12, 13], "open": 12, "issu": [8, 12], "start": [0, 7, 8, 10, 12], "discuss": 8, "encount": [], "propos": [], "section": 10, "set": [0, 3, 8, 9, 12], "ensur": 12, "talk": [], "your": [8, 9, 12], "avail": [], "hardwar": [], "9": 9, "newer": 9, "jaxlib": [9, 12], "acceler": [0, 8, 9, 10], "onli": [0, 12], "rocm": [9, 12], "numpi": [7, 9, 10, 12, 13], "scipi": [], "pypi": 9, "recommend": [7, 9], "microjaxx": [9, 12], "name": 9, "upgrad": [0, 9, 12, 13], "latest": 9, "releas": 9, "develop": [9, 10], "git": 9, "clone": 9, "http": 9, "shotamiyazaki94": 9, "offici": [9, 12], "guid": [7, 9], "wheel": 9, "verifi": 10, "detect": 9, "correctli": [], "print": [9, 12], "__version__": [9, 12], "precis": 12, "continu": [], "usag": [0, 7, 8, 9, 10, 12], "snippet": [7, 12], "review": [], "plan": [], "suit": 10, "toolkit": 10, "top": 10, "contour": [7, 10, 13], "trajectori": [0, 7, 8, 10, 11], "readi": [7, 10], "likelihood": [0, 7, 10, 11, 13], "companion": [], "readm": [], "walk": 9, "common": [9, 12, 13], "while": 0, "link": [], "detail": [], "public": 7, "next": 10, "light": [0, 7, 13], "tip": 10, "code": [7, 10, 12], "style": 10, "ask": [], "question": 10, "rai": [7, 10, 11, 13], "lightcurv": [7, 10, 11, 13], "solver": [0, 7, 10, 11, 12, 13], "highlight": [], "past": [], "notebook": [], "script": 12, "onc": 13, "notat": [], "1j": [0, 9, 10, 13], "05": 13, "05j": 13, "centr": 10, "shoot": 10, "fallback": 0, "02": 13, "alpha": 13, "30": [], "deg2rad": 13, "800": [], "y1": 13, "co": 13, "y2": 13, "dtype": 13, "750": [], "400": 13, "mani": 12, "tune": 13, "trade": [], "execut": [8, 10], "speed": [], "abov": [], "adjust": [], "memori": [0, 10, 13], "budget": 13, "contain": [3, 7], "instanc": [], "expos": 7, "straight": [], "api": [7, 13], "global": [], "care": [], "about": [], "To": [], "just": [], "those": 3, "vmap": 0, "vectoris": [], "dict": 3, "n_branch": 3, "collaps": 3, "store": 3, "combin": [0, 10, 13], "deliv": [0, 10], "accur": [0, 10], "cost": 0, "manag": 0, "kei": [0, 10], "export": [0, 8], "estim": [0, 7], "everywher": [0, 10], "fail": 0, "heurist": [0, 7], "hybrid": 0, "trigger": [0, 12], "decid": [0, 7], "chunk": [0, 7], "expens": [0, 8], "call": [0, 7], "balanc": 0, "occup": 0, "limb": [0, 7, 10, 12], "darken": [0, 7, 10, 12], "awar": [0, 9, 10], "switch": [0, 7, 13], "seamlessli": 0, "uniform": 0, "profil": [0, 7, 10], "toggl": 0, "share": 0, "infrastructur": 0, "knob": 0, "behav": 0, "downstream": 0, "miyazaki": 0, "kawahara": 0, "prep": 0, "descript": 0, "forthcom": 0, "argument": [0, 13], "mirror": [0, 8, 13], "lower": 0, "level": [0, 7], "extended_sourc": 0, "along": 0, "trail": 0, "angular": 0, "einstein": 0, "radial": 0, "quadratur": [0, 8], "panel": 0, "azimuth": 0, "contract": 0, "factor": 0, "ring": 0, "bin": 0, "polar": 0, "mesh": 0, "structur": [0, 13], "radii": 0, "domain": 0, "size": [0, 12], "fed": 0, "keyword": [0, 13], "guard": 0, "veri": 0, "fire": 0, "recomput": 0, "mag_uniform": 0, "mag_limb_dark": 0, "lazili": 0, "block_until_readi": 0, "synchronis": 0, "asynchron": 0, "context": 0, "logic": 0, "current": [0, 13], "yet": 0, "been": 0, "specialis": 0, "receiv": 0, "must": [0, 9], "suppli": [0, 7, 13], "alwai": 0, "patch": 0, "cusp": 0, "reson": 0, "higher": [0, 7], "reach": 0, "converg": 0, "sketch": 7, "layout": 7, "orient": 7, "yourself": 7, "interfac": 7, "hous": 7, "machineri": 7, "driver": [7, 9, 12], "offer": [7, 13], "marginalis": [7, 10, 13], "drop": [7, 13], "numpyro": 7, "black": 7, "box": 7, "optimis": 7, "etc": 7, "compos": [7, 10], "photometr": [7, 10], "heavi": 7, "kernel": [7, 8], "workload": 7, "benefit": 7, "larg": 7, "stai": 7, "resid": [7, 8], "establish": 7, "baselin": 7, "re": 7, "previous": 7, "warm": 7, "graph": 7, "compact": 7, "dimension": 7, "throughout": 7, "semant": 7, "lead": [7, 13], "ax": [7, 13], "concret": 7, "brows": 7, "callabl": [7, 13], "signatur": 7, "regener": 8, "group": 8, "platform": [8, 9, 12], "visibl": 8, "forc": [8, 12], "determinist": 8, "xla_flag": 8, "xla_gpu_deterministic_op": 8, "artifact": 8, "autom": 8, "deploy": 8, "consid": 8, "ci": 8, "explicit": 8, "tidi": 8, "static": 8, "hint": 8, "gradual": 8, "being": 8, "pyright": 8, "product": [8, 13], "wrap": 8, "trace_funct": 8, "start_trac": 8, "trace": [8, 12], "viewabl": 8, "tensorboard": 8, "experi": 8, "benchmark": 8, "repres": 8, "interact": 8, "strongli": 8, "thread": 8, "pleas": 8, "inform": [8, 12], "saniti": 9, "11": 9, "compil": [9, 12, 13], "matplotlib": [9, 12], "seaborn": [9, 12], "plot": [9, 12], "recent": 9, "stabl": 9, "even": 9, "pick": 9, "cleanli": 9, "smoke": 9, "concept": [9, 10], "architectur": [9, 10], "explain": 9, "how": 9, "togeth": [9, 12], "troubleshoot": [9, 10], "list": 9, "pitfal": 9, "quick": 9, "hmc": 10, "vi": 10, "512": [10, 12, 13], "pi": 10, "4": [10, 13], "toi": [10, 13], "mag": [10, 13], "001": 10, "explor": 10, "dig": 10, "prerequisit": 10, "practic": 10, "my": 10, "stall": 10, "still": 10, "stuck": 10, "strategi": [10, 13], "data": 10, "further": 10, "read": 10, "tool": 10, "most": 12, "report": 12, "new": 12, "summaris": 12, "suggest": 12, "doubl": 12, "xla_python_client_prealloc": 12, "temporarili": 12, "multi": 12, "confirm": 12, "access": 12, "nvidia": 12, "smi": 12, "equival": 12, "scale": 12, "more": 12, "process": 12, "launch": 12, "decreas": 12, "turn": 12, "sensit": 12, "take": 12, "shorten": 12, "length": 12, "repeat": [12, 13], "recompil": 12, "pull": 12, "extra": 12, "manual": [12, 13], "intend": 12, "demo": 12, "happi": 12, "debug": 12, "document": 12, "chapter": 13, "relev": 13, "95": 13, "5e": 13, "40": 13, "60": 13, "1024": 13, "768": 13, "128": 13, "limit": 13, "shrink": 13, "challeng": 13, "6": 13, "210": 13, "functool": 13, "partial": 13, "grad": 13, "def": 13, "loglik": 13, "model_flux": 13, "data_flux": 13, "loglike_jit": 13, "dloglike_dq": 13, "block": 13, "miss": 13, "peak": 13, "interv": 13, "utilis": 13, "cach": 13, "instead": 13}, "objects": {"microjax.inverse_ray": [[0, 0, 0, "-", "lightcurve"]], "microjax.inverse_ray.lightcurve": [[0, 1, 1, "", "mag_binary"], [0, 1, 1, "", "mag_triple"]], "microjax": [[1, 0, 0, "-", "likelihood"], [2, 0, 0, "-", "multipole"], [3, 0, 0, "-", "point_source"], [4, 0, 0, "-", "poly_solver"], [6, 0, 0, "-", "utils"]], "microjax.likelihood": [[1, 1, 1, "", "linear_chi2"], [1, 1, 1, "", "nll_ulens"], [1, 1, 1, "", "nll_ulens_general"]], "microjax.point_source": [[3, 1, 1, "", "critical_and_caustic_curves"], [3, 1, 1, "", "lens_eq"], [3, 1, 1, "", "lens_eq_det_jac"], [3, 1, 1, "", "mag_point_source"]], "microjax.poly_solver": [[4, 1, 1, "", "poly_roots"], [4, 1, 1, "", "poly_roots_EA_multi"]], "microjax.trajectory": [[5, 0, 0, "-", "parallax"]], "microjax.trajectory.parallax": [[5, 1, 1, "", "compute_parallax"], [5, 1, 1, "", "getpsi"], [5, 1, 1, "", "peri_vernal"], [5, 1, 1, "", "prepare_projection_basis"], [5, 1, 1, "", "project_earth_position"], [5, 1, 1, "", "set_parallax"]], "microjax.utils": [[6, 1, 1, "", "first_nonzero"], [6, 1, 1, "", "first_zero"], [6, 1, 1, "", "last_nonzero"], [6, 1, 1, "", "match_points"], [6, 1, 1, "", "max_zero_avoiding"], [6, 1, 1, "", "mean_zero_avoiding"], [6, 1, 1, "", "min_zero_avoiding"], [6, 1, 1, "", "sparse_argsort"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"welcom": 10, "microjax": 10, "": 10, "document": [8, 10], "indic": 10, "tabl": 10, "test": 8, "packag": 7, "subpackag": [], "submodul": [], "conftest": [], "modul": [], "content": [], "util": [1, 6], "gpu": 12, "invers": 0, "rai": 0, "lightcurv": 0, "likelihood": 1, "multipol": 2, "point": [3, 13], "sourc": [3, 13], "polynomi": 4, "solver": 4, "design": [0, 4], "highlight": [0, 4, 10], "note": 4, "numer": 4, "behavior": 4, "trajectori": [5, 13], "function": [3, 5, 6], "convent": [3, 5, 7], "sign": 5, "develop": 8, "suit": 8, "code": 8, "style": 8, "where": [], "ask": [], "question": 8, "get": 9, "start": 9, "requir": [], "instal": 9, "first": [], "check": [], "next": 9, "step": [], "guid": [10, 13], "api": [10, 11], "refer": [10, 11], "usag": 13, "magnif": 13, "extend": [], "light": [], "curv": [], "helper": 13, "tip": 8, "coordin": 3, "workflow": 0, "outlin": 0, "concept": 7, "architectur": 7, "core": 7, "execut": 7, "model": 7, "accuraci": 7, "strategi": 7, "kei": 7, "data": 7, "further": 7, "read": 7, "tool": 8, "profil": 8, "support": 8, "prerequisit": 9, "verifi": 9, "environ": 9, "up": 9, "quick": 10, "peek": 10, "intern": 10, "contribut": 10, "troubleshoot": 12, "jax": 12, "cannot": 12, "see": 12, "my": 12, "mag_binari": 12, "i": 12, "slow": 12, "run": 12, "out": 12, "memori": 12, "gradient": 12, "comput": 12, "stall": 12, "import": 12, "error": 12, "option": 12, "depend": 12, "still": 12, "stuck": 12, "finit": 13, "binari": 13, "lens": 13, "tripl": 13, "autodiff": 13, "jit": 13, "best": 13, "practic": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Likelihood Utilities": [[1, "module-microjax.likelihood"]], "Multipole": [[2, "module-microjax.multipole"]], "Polynomial Solver": [[4, "module-microjax.poly_solver"]], "Design highlights": [[4, "design-highlights"], [0, "design-highlights"]], "Notes on numerical behavior": [[4, "notes-on-numerical-behavior"]], "Trajectories": [[5, "module-microjax.trajectory.parallax"]], "Functions": [[5, "functions"], [3, "functions"]], "Conventions": [[5, "conventions"]], "Sign Conventions": [[5, "sign-conventions"]], "Utility Functions": [[6, "module-microjax.utils"]], "API Reference": [[11, "api-reference"], [10, null]], "Point Source": [[3, "module-microjax.point_source"]], "Coordinate conventions": [[3, "coordinate-conventions"]], "Inverse-Ray Lightcurve": [[0, "module-microjax.inverse_ray.lightcurve"]], "Workflow outline": [[0, "workflow-outline"]], "Concepts & Architecture": [[7, "concepts-architecture"]], "Core packages": [[7, "core-packages"]], "Execution model": [[7, "execution-model"]], "Accuracy strategy": [[7, "accuracy-strategy"]], "Key data conventions": [[7, "key-data-conventions"]], "Further reading": [[7, "further-reading"]], "Development": [[8, "development"]], "Test suite": [[8, "test-suite"]], "Documentation": [[8, "documentation"]], "Code style & tooling": [[8, "code-style-tooling"]], "Profiling tips": [[8, "profiling-tips"]], "Questions & support": [[8, "questions-support"]], "Getting Started": [[9, "getting-started"]], "Prerequisites": [[9, "prerequisites"]], "Installation": [[9, "installation"]], "Verify the environment": [[9, "verify-the-environment"]], "Up next": [[9, "up-next"]], "Welcome to microJAX\u2019s documentation!": [[10, "welcome-to-microjax-s-documentation"]], "Highlights": [[10, "highlights"]], "Quick peek": [[10, "quick-peek"]], "Guides": [[10, null]], "Internals & Contribution": [[10, null]], "Indices and tables": [[10, "indices-and-tables"]], "Troubleshooting": [[12, "troubleshooting"]], "JAX cannot see my GPU": [[12, "jax-cannot-see-my-gpu"]], "mag_binary is slow or runs out of memory": [[12, "mag-binary-is-slow-or-runs-out-of-memory"]], "Gradient computations stall": [[12, "gradient-computations-stall"]], "Import errors for optional dependencies": [[12, "import-errors-for-optional-dependencies"]], "Still stuck?": [[12, "still-stuck"]], "Usage Guide": [[13, "usage-guide"]], "Point-source magnification": [[13, "point-source-magnification"]], "Finite-source binary lenses": [[13, "finite-source-binary-lenses"]], "Triple lenses": [[13, "triple-lenses"]], "Autodiff and jit": [[13, "autodiff-and-jit"]], "Trajectory helpers": [[13, "trajectory-helpers"]], "Best practices": [[13, "best-practices"]]}, "indexentries": {}})